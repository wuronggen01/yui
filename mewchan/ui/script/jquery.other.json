{"/library/lab.common/async.js":{"url":"/library/lab.common/async.js","content":{"encoding":"text","data":"var foundation=require(\"./foundation.js\"),PENDING=\"pending\",SUSPENDED=\"suspended\",CALLING=\"calling\",HELD=\"hold\",FULFILLED=\"fulfilled\",REJECTED=\"rejected\",setHiddenField=function(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,value:n})},Async=function(e,t,n){n||(n=[]),this.pool=foundation.objectize(t),this.state=PENDING,setHiddenField(this,\"action\",e),this.fulfilled=n,setHiddenField(this,\"followingAsyncs\",[]),setHiddenField(this,\"pendingTaskAsyncs\",[]),setHiddenField(this,\"pendingRejectedActions\",[function(e){this.followingAsyncs.forEach(function(e){if(e.state!==PENDING)throw new Error(\"Invalid state for following async\");e.state=REJECTED,e.fulfilled=this.fulfilled,e.pendingRejectedActions.length>0&&e.pendingRejectedActions.forEach(function(t){t.call(e.step,e.fulfilled)})}.bind(this)),this.followingAsyncs=[]}.bind(this)]),setHiddenField(this,\"pendingTests\",[]),this.testState=PENDING;var s=this,a=!1,i={pool:this.pool,hold:function(){var e=0,t=null;if(foundation.isKindOf(arguments[0],Number)&&(e=arguments[0]),foundation.isKindOf(arguments[arguments.length-1],Function)&&(t=arguments[arguments.length-1]),s.state!==CALLING)throw new Error(\"Invalid state for async step\");return s.state=HELD,e&&async.delay(e,function(){s.state===HELD&&(i.reject(new Error(\"The hold of the async step has been timeout\")),a=!0)}),t&&t.call(i),i},test:function(e){return e?i.reject(e):i.next.apply(i,Array.prototype.slice.call(arguments,1))},next:function(){if(!a){if(s.state!==HELD&&s.state!==CALLING)throw new Error(\"Invalid state for async step\");s.fulfilled=Array.prototype.slice.call(arguments,0),s.state=FULFILLED;var e=s.pendingTaskAsyncs;setHiddenField(async,\"pendingTaskAsyncs\",[]),setHiddenField(async,\"pendingRejectedActions\",[]),e.forEach(function(e){call.call(e,s.fulfilled)}),setHiddenField(async,\"followingAsyncs\",[])}},reject:function(e){if(!a){if(s.state!==HELD&&s.state!==CALLING)throw new Error(\"Invalid state for async step\");foundation.isKindOf(e,Error)||(e=new Error(e)),s.fulfilled=e,s.state=REJECTED;var t=s.pendingRejectedActions;setHiddenField(async,\"pendingTaskAsyncs\",[]),setHiddenField(async,\"pendingRejectedActions\",[]),t.forEach(function(e){e.call(i,s.fulfilled)}),setHiddenField(async,\"followingAsyncs\",[])}}};setHiddenField(this,\"step\",i)};Async.prototype.state=PENDING,Async.prototype.fulfilled=null;var call=function(e){if(this.state!==PENDING)throw new Error(\"Invalid state to call async task\");this.state=CALLING,foundation.isArrayLike(e)||(e=[e]);this.action.apply(this.step,e)};setHiddenField(Async.prototype,\"then\",function(e){var t=new Async(e,this.pool,Array.prototype.slice.call(arguments,1));switch(this.followingAsyncs.push(t),this.state){case PENDING:case CALLING:case HELD:this.pendingTaskAsyncs.push(t);break;case FULFILLED:call.call(t,this.fulfilled);break;case REJECTED:default:t.fulfilled=this.fulfilled,t.state=REJECTED}return t}),Object.defineProperty(Async.prototype,\"result\",{enumerable:!1,get:function(){return this.state===FULFILLED?this.fulfilled[0]:null}}),setHiddenField(Async.prototype,\"rejected\",function(e){switch(this.state){case PENDING:case CALLING:case HELD:this.pendingRejectedActions.push(e);break;case REJECTED:e.call(this.step,this.fulfilled);break;case FULFILLED:}return this}),setHiddenField(Async.prototype,\"pipe\",function(e){return this.then(function(){e.next.apply(e,arguments),this.next.apply(e,arguments)}).rejected(e.reject)}),setHiddenField(Async.prototype,\"async\",function(){var e=this;return async(function(){e.then(function(){e.next.apply(e,arguments),this.next.apply(this,arguments)}).rejected(e.reject)})}),setHiddenField(Async.prototype,\"finished\",function(e){this.then.call(this,function(){e.call(this,this.pool)});return this}),setHiddenField(Async.prototype,\"all\",function(e,t){return this.then(function(){e=foundation.copyAsArray(foundation.isKindOf(e,String)?this.pool[e]:e);var n=this,s=0,a=function(){if(s<e.length){var i=e[s];++s;var r=CALLING,o=!1,c={hold:function(){var e=0,t=null;if(foundation.isKindOf(arguments[0],Number)&&(e=arguments[0]),foundation.isKindOf(arguments[arguments.length-1],Function)&&(t=arguments[arguments.length-1]),r!==CALLING)throw new Error(\"Invalid state for async all\");return r=HELD,e&&async.delay(e,function(){r===HELD&&(c.reject(new Error(\"The hold of the async all has been timeout\")),o=!0)}),t&&t.call(c),c},test:function(e){return e?c.reject(e):c.next.apply(c,Array.prototype.slice.call(arguments,1))},next:function(){if(!o){if(r!==HELD&&r!==CALLING)throw new Error(\"Invalid state for async all\");r=FULFILLED,a()}},reject:function(){if(!o){if(r===FULFILLED||r===REJECTED)throw new Error(\"Invalid state for async all\");r=REJECTED,n.reject.apply(n,arguments)}},pool:n.pool};t.call(c,i,s-1,e)}else n.next()};a()})}),setHiddenField(Async.prototype,\"race\",function(){return this.any(arguments,function(e){e.call(this)})}),setHiddenField(Async.prototype,\"any\",function(e,t){return this.then(function(){e=foundation.copyAsArray(foundation.isKindOf(e,String)?this.pool[e]:e);var n=this,s=0,a=0;e.forEach(function(i,r){var o=CALLING,c=!1,l={hold:function(){var e=0,t=null;if(foundation.isKindOf(arguments[0],Number)&&(e=arguments[0]),foundation.isKindOf(arguments[arguments.length-1],Function)&&(t=arguments[arguments.length-1]),o!==CALLING)throw new Error(\"Invalid state for async step\");return o=HELD,e&&async.delay(e,function(){o===HELD&&(l.reject(new Error(\"The hold of the async step has been timeout\")),c=!0)}),t&&t.call(l),l},test:function(e){return e?l.reject(e):l.next.apply(l,Array.prototype.slice.call(arguments,1))},next:function(){if(!c){if(o!==HELD&&o!==CALLING)throw new Error(\"Invalid state for async all\");o=FULFILLED,++s,1===s&&n.next()}},reject:function(){if(!c){if(o===FULFILLED||o===REJECTED)throw new Error(\"Invalid state for async all\");o=REJECTED,++a,0===s&&a===e.length&&n.reject.apply(n,arguments)}},pool:n.pool};t.call(l,i,r,e)})})}),setHiddenField(Async.prototype,\"test\",function(e){switch(this.state){case PENDING:case CALLING:case HELD:this.pendingTests.push(e);break;case FULFILLED:switch(this.testState){case PENDING:var t=this;this.pendingTests.push(e);var n=!1,s={fail:function(){if(!n){if(t.testState!==CALLING&&t.testState!==HELD)throw new Error(\"Invalid test state for async test\");t.testState=PENDING,a()}},succeed:function(){if(!n){if(t.testState!==CALLING&&t.testState!==HELD)throw new Error(\"Invalid test state for async test\");t.testState=FULFILLED}},hold:function(){var e=0,a=null;if(foundation.isKindOf(arguments[0],Number)&&(e=arguments[0]),foundation.isKindOf(arguments[arguments.length-1],Function)&&(a=arguments[arguments.length-1]),t.testState!==CALLING)throw new Error(\"Invalid test state for async test\");return t.testState=HELD,e&&t.delay(e,function(){t.testState===HELD&&(this.fail(new Error(\"The hold of the async test has been timeout\")),n=!0)}.bind(this)),a&&a.call(s),s},pool:t.pool},a=function(){if(t.pendingTests.length>0){var e=t.pendingTests.shift();t.testState=CALLING,e.call(s)}};a();break;case CALLING:case HELD:this.pendingTests.push(e);break;case FULFILLED:}break;case REJECTED:}return this});var async=function(e){var t=e;foundation.isKindOf(e,Function)||(t=function(){this.next(e)});var n=new Async(t);return call.call(n),n};async.resolve=function(){var e=foundation.copyAsArray(arguments);return async(function(){this.next.apply(this,e)})},async.all=function(e,t){return async().all(e,t)},async.race=function(){var e=async();return e.race.apply(e,arguments)},async.any=function(e,t){return async().any(e,t)},async.reject=function(e){return async(function(){this.reject(e)})},async.test=function(e){return async().test(e)};var nextJobs=[],scheduledJobs=[],Job=function(e,t,n,s){this.id=null,this.type=e,this.time=t,this.state=SUSPENDED,this.called=!1,this.action=s,this.name=n};Object.defineProperty(Job.prototype,\"act\",{enumerable:!1,get:function(){var e=this,t=function(){return\"once\"===e.type.split(\".\")[0]&&e.called?void 0:(\"repeated.schedule\"===e.type&&e.handle&&(clearTimeout(e.handle),delete e.handle),-1===[REJECTED,SUSPENDED].indexOf(e.state)&&(e.called=!0,e.action.apply(this,arguments),\"once\"===e.type.split(\".\")[0]&&e.cancel()),e)};return t.job=e,t}}),Object.defineProperty(Job.prototype,\"cancel\",{enumerable:!1,get:function(){var e=this;return function(){if(e.state!==REJECTED){var t=scheduledJobs.indexOf(e);switch(-1!==t&&scheduledJobs.splice(t,1),e.state=REJECTED,e.type){case\"once.next\":var t=nextJobs.indexOf(e);-1!==t&&nextJobs.splice(t,1);break;case\"once.timeout\":case\"once.date\":case\"repeated.schedule\":clearTimeout(e.handle),delete e.handle;break;case\"repeated.timer\":clearInterval(e.handle);break;case\"once.tick\":}}return e}}}),Object.defineProperty(Job.prototype,\"suspend\",{enumerable:!1,get:function(){var e=this;return function(){if(\"once\"!==e.type.split(\".\")||!e.called){if(e.state!==SUSPENDED&&e.state!==REJECTED){e.state=SUSPENDED;var t=scheduledJobs.indexOf(e);switch(-1!==t&&scheduledJobs.splice(t,1),e.type){case\"once.next\":var t=nextJobs.indexOf(e);-1!==t&&nextJobs.splice(t,1);break;case\"once.timeout\":case\"repeated.schedule\":case\"once.date\":clearTimeout(e.handle),delete e.handle;break;case\"repeated.timer\":clearInterval(e.handle),delete e.handle;break;case\"once.tick\":}}return e}}}}),Object.defineProperty(Job.prototype,\"resume\",{enumerable:!1,get:function(){var e=this;return function(){if(e.state===SUSPENDED)switch(e.state=PENDING,scheduledJobs.push(e),e.type){case\"once.next\":0===nextJobs.length&&process.nextTick(function(){var e=nextJobs;nextJobs=[],e.forEach(function(e){e.act()})}),nextJobs.push(e);break;case\"once.timeout\":case\"once.date\":e.handle=setTimeout(e.act,e.time-(new Date).getTime());break;case\"repeated.schedule\":e.handle=setTimeout(e.act,e.time);break;case\"repeated.timer\":e.handle=setInterval(e.act,e.time);break;case\"once.tick\":process.nextTick(e.act)}return e}}}),Object.defineProperty(Job.prototype,\"schedule\",{enumerable:!1,get:function(){var e=this;return function(){return e.state===PENDING&&\"repeated.schedule\"===e.type&&e.called&&(e.called=!1,e.handle&&clearTimeout(e.handle),e.handle=setTimeout(e.act,e.time)),e}}}),Object.defineProperty(async,\"jobs\",{enumerable:!1,get:function(){return scheduledJobs.slice(0)}}),async.delay=function(){var e=null,t=null,n=null;foundation.isKindOf(arguments[0],Function)?(e=-1,t=arguments[0],n=arguments[1]):(e=arguments[0],t=arguments[1],n=arguments[2]);var s=null;if(-2===e)s=new Job(\"once.tick\",0,n,t);else if(-1===e)s=new Job(\"once.next\",0,n,t);else if(foundation.isKindOf(e,Number))s=new Job(\"once.timeout\",(new Date).getTime()+e,n,t);else{if(!foundation.isKindOf(e,Date))throw new Error(\"Unknown type of time for job to delay\");s=new Job(\"once.date\",e.getTime(),n,t)}return s.resume(),s},async.plan=function(e,t,n){return foundation.isKindOf(e,Number)&&(e=new Date(e)),async.delay(e,t,n)},async.schedule=function(e,t,n){return new Job(\"repeated.schedule\",e,n,t).resume()},async.timer=function(e,t,n){return new Job(\"repeated.timer\",e,n,t).resume()},async.isAsync=function(e){return e instanceof Async},async.ensure=function(e){return async.isAsync(e)?e:async.resolve(e)},module.exports=async;"}},"/library/lab.common/cache_pool.js":{"url":"/library/lab.common/cache_pool.js","content":{"encoding":"text","data":"var CachePool=function(e){this.timeout=parseInt(e),isNaN(this.timeout)&&(this.timeout=12e5),Object.defineProperty(this,\"pool\",{enumerable:!1,value:{}})},define=function(e,t){Object.defineProperty(CachePool.prototype,e,{enumerable:!1,value:t})};define(\"has\",function(e){return this.pool.hasOwnProperty(e)}),CachePool.prototype.working=!0,Object.defineProperty(CachePool.prototype,\"count\",{enumerable:!0,get:function(){return Object.keys(this.pool).length}}),define(\"get\",function(e,t,o,i){if(i||(i=this.timeout),this.pool.hasOwnProperty(e)){var n=this.pool[e];return t&&this.refresh(e,i),n.content}if(o){var r=o();return this.pool[e]={content:r},this.refresh(e,i),r}return null}),define(\"fetch\",function(e){return Object.keys(this.pool).filter(function(t){return e?e(t,this.pool[t].content):!0}.bind(this)).map(function(e){return{id:e,content:this.pool[e].content}}.bind(this))}),define(\"put\",function(e,t,o){o||(o=this.timeout),this.pool.hasOwnProperty(e)?(this.pool[e].content=t,this.pool[e].expiredDate=(new Date).getTime()+o):this.pool[e]={content:t,expiredDate:(new Date).getTime()+o},this.refresh(e)}),define(\"refresh\",function(e,t){t||(t=this.timeout),this.pool.hasOwnProperty(e)&&(this.pool[e].expiredDate=(new Date).getTime()+t)}),define(\"clearExpired\",function(){var e=(new Date).getTime();Object.keys(this.pool).slice(0).forEach(function(t){this.pool[t].expiredDate<e&&delete this.pool[t]}.bind(this))}),module.exports=CachePool;"}},"/library/lab.common/comparator.js":{"url":"/library/lab.common/comparator.js","content":{"encoding":"text","data":"var foundation=null,numberComparator=function(a,r){return r>a?-1:a>r?1:a===r?0:-1},dateComparator=function(a,r){return a=a.getTime(),r=r.getTime(),r>a?-1:a>r?1:a===r?0:-1},stringComparator=function(a,r){return a.localeCompare(r)},naturalComparator=function(a,r){var t,e,n=/(^([+\\-]?(?:\\d*)(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)?$|^0x[\\da-fA-F]+$|\\d+)/g,o=/^\\s+|\\s+$/g,i=/\\s+/g,u=/(^([\\w ]+,?[\\w ]+)?[\\w ]+,?[\\w ]+\\d+:\\d+(:\\d+)?[\\w ]?|^\\d{1,4}[\\/\\-]\\d{1,4}[\\/\\-]\\d{1,4}|^\\w+, \\w+ \\d+, \\d{4})/,p=/^0x[0-9a-f]+$/i,l=/^0/,s=function(a){return(!1||\"\"+a).replace(o,\"\")},c=s(a)||\"\",d=s(r)||\"\",f=c.replace(n,\"\\x00$1\\x00\").replace(/\\0$/,\"\").replace(/^\\0/,\"\").split(\"\\x00\"),m=d.replace(n,\"\\x00$1\\x00\").replace(/\\0$/,\"\").replace(/^\\0/,\"\").split(\"\\x00\"),g=parseInt(c.match(p),16)||1!==f.length&&Date.parse(c),C=parseInt(d.match(p),16)||g&&d.match(u)&&Date.parse(d)||null,h=function(a,r){return a?(!a.match(l)||1==r)&&parseFloat(a)||a.replace(i,\" \").replace(o,\"\")||0:0};if(C){if(C>g)return-1;if(g>C)return 1}for(var x=0,N=f.length,w=m.length,$=Math.max(N,w);$>x;x++){if(t=h(f[x],N),e=h(m[x],w),isNaN(t)!==isNaN(e))return isNaN(t)?1:-1;if(typeof t!=typeof e&&(t+=\"\",e+=\"\"),e>t)return-1;if(t>e)return 1}return 0},insensitiveNaturalComparator=function(a,r){var t,e,n=/(^([+\\-]?(?:\\d*)(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)?$|^0x[\\da-fA-F]+$|\\d+)/g,o=/^\\s+|\\s+$/g,i=/\\s+/g,u=/(^([\\w ]+,?[\\w ]+)?[\\w ]+,?[\\w ]+\\d+:\\d+(:\\d+)?[\\w ]?|^\\d{1,4}[\\/\\-]\\d{1,4}[\\/\\-]\\d{1,4}|^\\w+, \\w+ \\d+, \\d{4})/,p=/^0x[0-9a-f]+$/i,l=/^0/,s=function(a){return(!0&&(\"\"+a).toLocaleLowerCase()||\"\"+a).replace(o,\"\")},c=s(a)||\"\",d=s(r)||\"\",f=c.replace(n,\"\\x00$1\\x00\").replace(/\\0$/,\"\").replace(/^\\0/,\"\").split(\"\\x00\"),m=d.replace(n,\"\\x00$1\\x00\").replace(/\\0$/,\"\").replace(/^\\0/,\"\").split(\"\\x00\"),g=parseInt(c.match(p),16)||1!==f.length&&Date.parse(c),C=parseInt(d.match(p),16)||g&&d.match(u)&&Date.parse(d)||null,h=function(a,r){return a?(!a.match(l)||1==r)&&parseFloat(a)||a.replace(i,\" \").replace(o,\"\")||0:0};if(C){if(C>g)return-1;if(g>C)return 1}for(var x=0,N=f.length,w=m.length,$=Math.max(N,w);$>x;x++){if(t=h(f[x],N),e=h(m[x],w),isNaN(t)!==isNaN(e))return isNaN(t)?1:-1;if(typeof t!=typeof e&&(t+=\"\",e+=\"\"),e>t)return-1;if(t>e)return 1}return 0},generatePathComparator=function(a,r,t){return foundation||(foundation=require(\"./foundation.js\")),function(e,n){var o=foundation.getProperty(e,a),i=n;switch(t||(i=foundation.getProperty(n,a)),r){case\"date\":{foundation.convert(o,\"date\"),foundation.convert(i,\"date\")}case\"string\":return foundation.isNull(o)?foundation.isNull(i)?0:-1:foundation.isNull(i)?1:(o+\"\").localeCompare(i+\"\");case\"natural\":return naturalComparator(o,i);case\"insensitive-natural\":return insensitiveNaturalComparator(o,i);case\"number\":default:return i>o?-1:o>i?1:o===i?0:-1}}};module.exports={numberComparator:numberComparator,dateComparator:dateComparator,stringComparator:stringComparator,naturalComparator:naturalComparator,insensitiveNaturalComparator:insensitiveNaturalComparator,generatePathComparator:generatePathComparator};"}},"/library/lab.common/foundation.js":{"url":"/library/lab.common/foundation.js","content":{"encoding":"text","data":"var comparator=require(\"./comparator.js\"),template=require(\"./template.js\"),uuid=require(\"./uuid.js\"),Logger=null,Buffer=global.Buffer;Buffer||(Buffer=function(){},Buffer.prototype.toString=function(){},global.Buffer=Buffer);var Symbol=global.Symbol;Symbol||(Symbol=function(){this.key=uuid.createUUID()},Symbol.prototype.toString=function(){return this.key},global.Symbol=Symbol);var deprecated=function(e,r,t){var n=!1;return function(){if(!n){n=!0;var i=require(\"./logger.js\");(new i).warn(\"Function \"+e+\" is deprecated, please use \"+r)}return t.apply(this,arguments)}},getScriptEngineName=function(){return Object.prototype.toSource&&Object.prototype.watch&&Object.prototype.unwatch?\"SM\":\"V8\"},objectize=function(e){return isNull(e)&&(e={}),function(){return this}.bind(e)()},isNull=function(e){return null===e||void 0===e},isKindOf=function(e,r){if(isNull(e))return!1;switch(typeof e){case\"boolean\":return r===Boolean;case\"number\":return r===Number;case\"string\":return r===String;case\"function\":return r===Function;case\"symbol\":return r===Symbol;case\"undefined\":return!1;case\"object\":default:return e instanceof r}},simplify=function(e){if(isNull(e))return null;switch(typeof e){case\"boolean\":case\"number\":case\"string\":case\"function\":case\"symbol\":return e;case\"undefined\":return!1;case\"object\":default:return e instanceof Boolean?e&&!0:e instanceof Number?e+0:e instanceof String?e+\"\":e}},prepadZero=function(e,r){for(e+=\"\";e.length<r;)e=\"0\"+e;return e},jsonizeIndentUnit=\"    \",jsonizeMaximumLevel=3,jsonize=function(e,r,t){if(t=parseInt(t),isFinite(t)||(t=jsonizeMaximumLevel),null===e)return\"null\";if(void 0===e)return\"undefined\";if(isKindOf(e,Boolean))return e?\"true\":\"false\";if(isKindOf(e,Number))return e+\"\";if(isKindOf(e,String))return'\"'+e.replace(/\\\\/gim,\"\\\\\\\\\").replace(/\\n/gim,\"\\\\n\").replace(/\\r/gim,\"\\\\r\").replace(/\"/gim,'\\\\\"')+'\"';if(isKindOf(e,RegExp))return\"/\"+e.source+\"/\"+(e.global?\"g\":\"\")+(e.ignoreCase?\"i\":\"\")+(e.multiline?\"m\":\"\");if(isKindOf(e,Function))return e.name?\"function \"+e.name+\"() { /* code */ }\":\"function () { /* code */ }\";if(isKindOf(e,Date))return'new Date(\"'+formatDate(e)+'\")';if(isKindOf(e,Error))return r=r?r:\"\",\"new \"+e.name+'(\"'+e.message.replace(/\\\\/gim,\"\\\\\\\\\").replace(/\\n/gim,\"\\\\n\").replace(/\\r/gim,\"\\\\r\").replace(/\"/gim,'\\\\\"')+'\") /*\\n'+getStack(e).split(\"\\n\").map(function(e){return r+e}).join(\"\\n\")+\"\\n\"+r+\"*/\";if(isKindOf(e,Array)){if(e.length>0){if(r&&r.length/jsonizeIndentUnit.length>=t)return\"[ /* \"+e.length+\" items ... */ ]\";var n=[\"[\",\" \",\"/* \",e.length,\" \",\"items\",\" */\",\"\\n\"],i=(r?r:\"\")+jsonizeIndentUnit;return e.forEach(function(r,a){n.push(i),n.push(jsonize(r,i,t)),a<e.length-1&&n.push(\",\"),n.push(\"\\n\")}),r&&n.push(r),n.push(\"]\"),n.join(\"\")}return\"[]\"}var a=[],u=[];for(var s in e)isKindOf(e[s],Function)?-1===u.indexOf(s)&&u.push(s):-1===a.indexOf(s)&&void 0!==e[s]&&a.push(s);a=a.sort(comparator.insensitiveNaturalComparator),u=u.sort(comparator.insensitiveNaturalComparator);var l=e.constructor.name;if(l=l?\" /* \"+l:\"\",e.constructor===Object&&(l=\"\"),a.length>0||u.length>0){if(r&&r.length/jsonizeIndentUnit.length>=t)return l?\"{\"+l+\" ... */ }\":\"{ /* ... */ }\";var n=[\"{\",l];l&&n.push(\" */\"),n.push(\"\\n\");var i=(r?r:\"\")+jsonizeIndentUnit;return a.forEach(function(r,s){n.push(i),n.push(jsonize(r)),n.push(\": \"),n.push(jsonize(e[r],i,t)),(s<a.length-1||u.length>0)&&n.push(\",\"),n.push(\"\\n\")}),u.forEach(function(r,a){n.push(i),n.push(jsonize(r)),n.push(\": \"),n.push(jsonize(e[r],i,t)),a<u.length-1&&n.push(\",\"),n.push(\"\\n\")}),r&&n.push(r),n.push(\"}\"),n.join(\"\")}return l?\"{\"+l+\" */ }\":\"{}\"},isArrayLike=function(e,r){return isNull(e)?!1:e.constructor===String?r?!0:!1:isFinite(parseInt(e.length))},iterateArray=function(e,r){isArrayLike(e)&&Array.prototype.forEach.call(e,r)},copyAsArray=function(e){return isArrayLike(e)?Array.prototype.slice.call(e,0):[]},formatDate=function(e,r,t){var n=function(e,r){for(e+=\"\";e.length<r;)e=\"0\"+e;return e};e||(e=new Date),r||(r=\"YYYY-MM-DD hh:mm:ss.SSS\");for(var i=[],a=0;a<r.length;)switch(r[a]){case\"Y\":\"Y\"==r[a+1]?\"Y\"==r[a+2]&&\"Y\"==r[a+3]?(i.push(n(t?e.getUTCFullYear():e.getFullYear(),4)),a+=4):(i.push(n((t?e.getUTCFullYear():e.getFullYear())%100,2)),a+=2):(i.push((t?e.getUTCFullYear():e.getFullYear())+\"\"),++a);break;case\"M\":\"M\"==r[a+1]?(i.push(n((t?e.getUTCMonth():e.getMonth())+1,2)),a+=2):(i.push((t?e.getUTCMonth():e.getMonth())+1+\"\"),++a);break;case\"D\":\"D\"==r[a+1]?(i.push(n(t?e.getUTCDate():e.getDate(),2)),a+=2):(i.push((t?e.getUTCDate():e.getDate())+\"\"),++a);break;case\"h\":\"h\"==r[a+1]?(i.push(n(t?e.getUTCHours():e.getHours(),2)),a+=2):(i.push((t?e.getUTCHours():e.getHours())+\"\"),++a);break;case\"m\":\"m\"==r[a+1]?(i.push(n(t?e.getUTCMinutes():e.getMinutes(),2)),a+=2):(i.push((t?e.getUTCMinutes():e.getMinutes())+\"\"),++a);break;case\"s\":\"s\"==r[a+1]?(i.push(n(t?e.getUTCSeconds():e.getSeconds(),2)),a+=2):(i.push((t?e.getUTCSeconds():e.getSeconds())+\"\"),++a);break;case\"S\":\"S\"==r[a+1]&&\"S\"==r[a+2]?(i.push(n(t?e.getUTCMilliseconds():e.getMilliseconds(),3)),a+=3):(i.push((t?e.getUTCMilliseconds():e.getMilliseconds())+\"\"),++a);break;case'\"':case\"'\":for(var u=1;r[a+u]!=r[a]&&a+u<r.length;)\"\\\\\"==r[a+u]?(i.push(r[a+u+1]),u+=2):(i.push(r[a+u]),++u);a+=u+1;break;default:i.push(r[a]),++a}return i.join(\"\")},iterateObject=function(e){if(!(isNull(e)||isKindOf(e,Boolean)||isKindOf(e,Number)||isKindOf(e,String)||isKindOf(e,Date)||isKindOf(e,RegExp))){var r=!1;3===arguments.length&&(r=arguments[1]?!0:!1);var t=arguments[arguments.length-1];Object.keys(e).slice(0).forEach(function(n){(e.hasOwnProperty(n)||r)&&t(n,e[n])})}},couldBeAcceptedAs=function(e,r){var t=\"m\";switch(r&&0===r.indexOf(\"regex-source-\")&&(t=r.split(\"-\")[2],r=\"regex-source\"),r){case\"boolean\":return isKindOf(e,Boolean);case\"number\":return isKindOf(e,Number);case\"string\":return isKindOf(e,String);case\"buffer\":return isKindOf(e,Buffer);case\"date\":return isKindOf(e,Date);case\"regex\":return isKindOf(e,RegExp);case\"function\":return isKindOf(e,Function);case\"array\":return isKindOf(e,Array);case\"array-like\":return isArrayLike(e);case\"object\":return isNull(e)||isKindOf(e,Boolean)||isKindOf(e,Number)||isKindOf(e,String)||isKindOf(e,RegExp)||isKindOf(e,Date)||isKindOf(e,Function)?!1:!0;case\"any\":return!0;default:return isKindOf(r,Function)&&isKindOf(e,r)?!0:!1}},getStack=function(e){var r=null;switch(e?(r=e.stack.split(\"\\n\"),\"V8\"===getScriptEngineName()&&(r=r.slice(1))):(r=new Error(\"Get stack\").stack.split(\"\\n\"),r=r.slice(\"V8\"===getScriptEngineName()?2:1)),getScriptEngineName()){case\"SM\":return\"    at \"!==r[0].substring(0,7)?r.join(\"\\n\").trim().split(\"\\n\").map(function(e){var r=e.split(\"@\");return r[0].trim().length>0?\"    at \"+r[0]+\" (\"+r.slice(1).join(\"@\")+\")\":\"    at Object.<anonymous> (\"+r.slice(1).join(\"@\")+\")\"}).join(\"\\n\"):r.join(\"\\n\");case\"V8\":return r.join(\"\\n\");default:return r.join(\"\\n\")}},convert=function(e,r,t){var n=\"m\";r&&0===r.indexOf(\"regex-source-\")&&(n=r.split(\"-\")[2],r=\"regex-source\");var i=function(e){if(t&&t.validator){if(template.execute(t.validator,{data:e},{functors:{isArrayLike:function(e,r,t,n,i){return isArrayLike(i)},\"enum\":function(e,r,t,n){var i=Array.prototype.slice.call(arguments,4);return-1!==i.indexOf(t.data)},range:function(e,r,t,n,i,a,u,s){return t.data>=i&&t.data<=a?u&&t.data===i?!1:s&&t.data===a?!1:!0:!1},notNull:function(e,r,t,n){return null!==t.data&&void 0!==t.data},notEmpty:function(e,r,t,n){return isKindOf(t.data,String)?t.data.length>0:isKindOf(t.data,Array)?t.data.length>0:isArrayLike(t.data)?t.data.length>0:null!==t.data&&void 0!==t.data}}}))return e;if(t.hasOwnProperty(\"failedValue\"))return t.failedValue;throw new Error(\"Invalid value: \"+e)}return e};switch(r){case\"boolean\":return i(isNull(e)&&t?t.defaultValue?!0:!1:e?!0:!1);case\"number\":var a=NaN;a=t&&t.numberAsInteger?parseInt(e):parseFloat(e);var u=!1;return u=t&&t.numberShouldFinite?!isFinite(a):isNaN(a),u&&(t&&t.numberAsInteger?a=parseInt(t.defaultValue):t&&(a=parseFloat(t.defaultValue))),i(a);case\"string\":if(isKindOf(e,Date))return i(formatDate(e,\"YYYY-MM-DDThh:mm:ss.SSSZ\",!0));if(isArrayLike(e)&&t&&t.stringDelimiter)return i(copyAsArray(e).join(t.stringDelimiter));var s;return isNull(e)||(s=t&&t.autotrim?(\"\"+e).trim():\"\"+e),t&&t.emptyAsNull&&0===s.length&&(s=null),isNull(s)&&t&&!isNull(t.defaultValue)&&(s=\"\"+t.defaultValue),i(s);case\"buffer\":return isKindOf(e,String)?i(new Buffer(e,\"utf8\")):isKindOf(e,Buffer)?i(e):(e=t.defaultValue,isKindOf(e,String)?i(new Buffer(e,\"utf8\")):isKindOf(e,Buffer)?i(e):null);case\"date\":return i(isKindOf(e,String)?/^(\\-?)[0-9]+$/.test(e)?new Date(parseInt(e)):new Date(e):isKindOf(e,Number)?new Date(e):isKindOf(e,Date)?e:t?isNull(t.defaultValue)?null:t.defaultValue:null);case\"regex\":case\"regex-ignore-case\":if(isNull(e)&&t&&(e=t.defaultValue),isKindOf(e,RegExp))return i(e);if(isNull(e))return i(null);var l=new RegExp(\"^\"+(e+\"\").replace(/[\\$\\^\\*\\(\\)\\-\\+\\[\\]\\{\\}\\\\\\|\\,\\?\\/\\.]/g,function(e){return\"\\\\\"+e})+\"$\",\"m\");return l.fromString=e,i(l);case\"regex-asterisk\":if(isNull(e)&&t&&(e=t.defaultValue),isKindOf(e,RegExp))return i(e);if(isNull(e))return i(null);var l=new RegExp(\"^\"+(e+\"\").replace(/[\\$\\^\\(\\)\\-\\+\\[\\]\\{\\}\\\\\\|\\,\\?\\/\\.]/g,function(e){return\"\\\\\"+e}).replace(/\\*/g,\".*\")+\"$\",\"m\");return l.fromString=e,i(l);case\"regex-asterisk-dot\":if(isNull(e)&&t&&(e=t.defaultValue),isKindOf(e,RegExp))return i(e);if(isNull(e))return i(null);var l=new RegExp(\"^\"+(e+\"\").replace(/[\\$\\^\\(\\)\\-\\+\\[\\]\\{\\}\\\\\\|\\,\\?\\/\\.]/g,function(e){return\"\\\\\"+e}).replace(/(\\\\\\.)*(\\*+)(\\\\\\.)*/g,function(e){return\"\\\\.\"===e.slice(0,2)?\"\\\\.\"===e.slice(-2)?\"(\\\\.|\\\\..+\\\\.)\":\"(\\\\..+)?\":\"\\\\.\"===e.slice(-2)?\"(.+\\\\.)?\":\".*\"})+\"$\",\"m\");return l.fromString=e,i(l);case\"regex-path\":if(isNull(e)&&t&&(e=t.defaultValue),isKindOf(e,RegExp))return i(e);if(isNull(e))return i(null);var l=new RegExp(\"^\"+(e+\"\").replace(/[\\\\\\/]+$/,\"\").replace(/((^|[^\\\\\\/])[\\\\\\/]([^\\\\\\/]|$))|([\\$\\^\\(\\)\\-\\+\\[\\]\\{\\}\\|\\,\\\\\\/\\.])/g,function(e){return e.length>1?e.replace(/[\\\\\\/]/g,\"[\\\\\\\\\\\\/]\"):\"\\\\\"+e}).replace(/^(\\\\\\/){2,}/g,\"(.+[\\\\/\\\\\\\\])?\").replace(/(\\\\\\/){2,}/g,\"([\\\\/\\\\\\\\].+[\\\\/\\\\\\\\]|[\\\\/\\\\\\\\])\").replace(/\\*/g,\"[^\\\\/\\\\\\\\\\\\*\\\\?]+\")+\"$\",\"im\");return l.fromString=e,i(l);case\"regex-source\":if(isNull(e)&&t&&(e=t.defaultValue),isKindOf(e,RegExp))return i(e);if(isNull(e))return i(null);var l=new RegExp(e+\"\",n);return l.fromString=e,i(l);case\"function\":return i(isKindOf(e,Function)?e:isNull(e)?t&&t.hasOwnProperty(\"defaultValue\")?isKindOf(t.defaultValue,Function)?t.defaultValue:function(){return t.defaultValue}:function(){return e}:function(){return e});case\"array\":var o=null;if(isNull(e)&&t&&(e=t.defaultValue),isKindOf(e,String))if(t&&t.stringDelimiter)if(isArrayLike(t.stringDelimiter)){var l=new RegExp(\"(\"+t.stringDelimiter.map(function(e){return(e+\"\").replace(/[\\$\\^\\*\\(\\)\\-\\+\\[\\]\\{\\}\\\\\\|\\,\\?\\/\\.]/g,function(e){return\"\\\\\"+e})}).join(\")|(\")+\")\");o=e.split(l).filter(function(e){return isNull(e)?!1:!l.test(e)})}else o=e.split(t.stringDelimiter);else t&&t.autowrapAsArray&&(o=[e]);else isArrayLike(e)?o=copyAsArray(e):t&&t.autowrapAsArray&&(o=[e]);if(o){if(t&&t.autotrim&&(o=o.map(function(e){return isKindOf(e,String)?e.trim():e})),t&&t.ignoreEmptyElement&&(o=o.filter(function(e){return e?!0:!1})),t&&t.uniqueElement){var c=[];o.forEach(function(e){-1===c.indexOf(e)&&c.push(e)}),o=c}}else o=[];return i(o);case\"array-autoindex\":isNull(e)&&t&&(e=t.defaultValue);var o=[];if(e&&Object.keys(e).forEach(function(r){o.push(e[r])}),t&&t.autotrim&&(o=o.map(function(e){return isKindOf(e,String)?e.trim():e})),t&&t.ignoreEmptyElement&&(o=o.filter(function(e){return e?!0:!1})),t&&t.uniqueElement){var c=[];o.forEach(function(e){-1===c.indexOf(e)&&c.push(e)}),o=c}return i(o);case\"object\":if(isNull(e)&&t&&(e=t.defaultValue),isNull(e)||isKindOf(e,Boolean)||isKindOf(e,Number)||isKindOf(e,String)||isKindOf(e,RegExp)||isKindOf(e,Date))return i({});var s={};return iterateObject(e,function(e,r){s[e]=r}),i(s);default:return i(isKindOf(r,Function)?isKindOf(e,r)?e:new r(e):e)}},merge=function(){var e=copyAsArray(arguments);return e.unshift({}),advancedMerge.apply(this,e)},advancedMerge=function(e){var r=null;e&&e[\"!noLogger\"]?r={warn:function(e){}}:(Logger||(Logger=require(\"./logger.js\")),r=new Logger);var t=null;return copyAsArray(arguments).slice(1).forEach(function(n){var i=function(e,t,n,a,u){if(n||(n={}),a){var s={};Object.keys(a).forEach(function(e){s[e]=a[e]}),a=s}else a={};if(u){var l={};Object.keys(a).forEach(function(e){l[e]=u[e]}),u=l}else u={};n[\"!templateData\"]&&Object.keys(n[\"!templateData\"]).forEach(function(e){a[e]=n[\"!templateData\"][e]}),n[\"!templateFunctors\"]&&Object.keys(n[\"!templateFunctors\"]).forEach(function(e){u[e]=n[\"!templateFunctors\"][e]}),n[\"!warningMessage\"]&&r.warn(n[\"!warningMessage\"]);var o=\"unknown\",c=function(e,r){if(o=r,n[e]){var i={};n[e].split(/[\\s,]+/g).forEach(function(e){i[e]=t}),t=i}},f=function(e){if(n[\"!postscript\"]){var r={};return Object.keys(a).forEach(function(e){r[e]=a[e]}),r.data=e,template.execute(n[\"!postscript\"],r,{functors:u})}return e};if(isNull(t)||isKindOf(t,Symbol))n[\"!nullOperation\"]?operation=n[\"!nullOperation\"]:operation=\"omit\",o=\"null\";else if(isKindOf(t,Boolean))c(\"!booleanFields\",\"boolean\");else if(isKindOf(t,Number))c(\"!numberFields\",\"number\");else if(isKindOf(t,String))c(\"!stringFields\",\"string\");else if(isKindOf(t,Buffer))c(\"!bufferFields\",\"buffer\");else if(isKindOf(t,Date))c(\"!dateFields\",\"date\");else if(isKindOf(t,RegExp))c(\"!regexFields\",\"regex\");else if(isKindOf(t,Function)&&n[\"!functionField\"])c(\"!functionFields\",\"function\");else if(Array.isArray(t))if(n[\"!arrayFields\"]){var d={};n[\"!arrayFields\"].split(/[\\s,]+/g).forEach(function(e){d[e]=t}),t=d}else n[\"!arrayOperation\"]&&(operation=n[\"!arrayOperation\"]),o=\"array\";else o=\"object\";var p={stringDelimiter:n[\"!stringDelimiter\"],autowrapAsArray:!0,autotrim:n[\"!autotrimString\"],ignoreEmptyElement:n[\"!ignoreEmptyElement\"],defaultValue:n[\"!defaultValue\"],numberAsInteger:n[\"!numberAsInteger\"],validator:n[\"!validator\"]};if(n.hasOwnProperty(\"!failedValue\")&&(p.failedValue=n[\"!failedValue\"]),t=convert(t,n[\"!valueType\"],p),isNull(t)||\"null\"===o)return f(\"overwrite\"===n[\"!nullOperation\"]?isNull(n[\"!defaultValue\"])?null:i(null,n[\"!defaultValue\"],n,a,u):isNull(e)&&!isNull(n[\"!defaultValue\"])?i(null,n[\"!defaultValue\"],n,a,u):e);var g=n[\"!valueType\"];g&&0===g.indexOf(\"regex\")&&(g=\"regex\");var m=function(r){return isNull(e)?isNull(n[\"!defaultValue\"])?t:r(convert(n[\"!defaultValue\"],n[\"!valueType\"]),t):r(e,t)};switch(g){case\"boolean\":switch(n[\"!operation\"]){case\"and\":return f(m(function(e,r){return e&&r}));case\"or\":return f(m(function(e,r){return e||r}));case\"overwrite\":default:return f(t)}case\"number\":switch(n[\"!operation\"]){case\"plus\":return f(m(function(e,r){return e+r}));case\"multiply\":return f(m(function(e,r){return e*r}));case\"and\":return f(m(function(e,r){return e&r}));case\"or\":return f(m(function(e,r){return e|r}));case\"xor\":return f(m(function(e,r){return e^r}));case\"min\":return f(m(function(e,r){return Math.min(e,r)}));case\"max\":return f(m(function(e,r){return Math.max(e,r)}));case\"overwrite\":default:return f(t)}case\"string\":switch(n[\"!operation\"]){case\"plus\":case\"concat\":return f(m(function(e,r){return isNull(n[\"!stringDelimiter\"])?e+r:e&&r?e+n[\"!stringDelimiter\"]+r:e+r}));case\"overwrite\":default:return f(t)}case\"buffer\":switch(n[\"!operation\"]){case\"concat\":return f(m(function(e,r){return Buffer.concat([e,r])}));case\"overwrite\":default:return f(t)}case\"date\":switch(n[\"!operation\"]){case\"min\":return f(m(function(e,r){return e.getTime()<r.getTime()?e:r}));case\"max\":return f(m(function(e,r){return e.getTime()>r.getTime()?e:r}));case\"overwrite\":default:return f(t)}case\"regex\":return f(t);case\"function\":var h=function(e,r,t){return function(){if(e){var n=e.apply(this,arguments);return r?t(n,r.apply(this,arguments)):t(n)}return r?t(r.apply(this,arguments)):t()}},y=function(r){return isNull(e)?isNull(n[\"!defaultValue\"])?t:h(t,convert(n[\"!defaultValue\"],n[\"!valueType\"]),r):h(t,convert(e,n[\"!valueType\"]),r)};switch(n[\"!operation\"]){case\"multicall\":return f(y(function(){}));case\"plus\":return f(y(function(){var e=0;return copyAsArray(arguments).forEach(function(r){e+=r}),e}));case\"multiply\":return f(y(function(){var e=1;return copyAsArray(arguments).forEach(function(r){e*=r}),e}));case\"and\":return f(y(function(){var e=1;return copyAsArray(arguments).forEach(function(r){e=e&&r}),e}));case\"or\":return f(y(function(){var e=0;return copyAsArray(arguments).forEach(function(r){e=e||r}),e}));case\"min\":return f(y(function(){return Math.min.apply(Math,arguments)}));case\"max\":return f(y(function(){return Math.max.apply(Math,arguments)}));case\"concat\":return f(y(function(){var e=[];return copyAsArray(arguments).forEach(function(r){e.push(i(null,r,n[\"!resultVariant\"],a,u))}),e}));case\"union\":return f(y(function(){var e=[];return copyAsArray(arguments).forEach(function(r){-1===e.indexOf(r)&&e.push(i(null,r,n[\"!resultVariant\"],a,u))}),e}));case\"merge\":return f(y(function(){var e=copyAsArray(arguments);return e.unshift(n[\"!resultVariant\"]),advancedMerge.call(this,e)}));case\"overwrite\":default:return f(t)}case\"array\":case\"array-autoindex\":switch(n[\"!operation\"]){case\"concat\":var O=[];return iterateArray(e,function(e){O.push(i(null,e,n[\"!arrayElement\"],a,u))}),iterateArray(t,function(e){O.push(i(null,e,n[\"!arrayElement\"],a,u))}),f(O);case\"union\":var O=[];return iterateArray(e,function(e){e=i(null,e,n[\"!arrayElement\"],a,u);var r=getIndex(O,n[\"!comparatorPath\"],n[\"!comparatorType\"],getProperty(e,n[\"!comparatorPath\"]));-1===r?O.push(e):O[r]=i(O[r],e,n[\"!arrayElement\"],a,u)}),iterateArray(t,function(e){e=i(null,e,n[\"!arrayElement\"],a,u);var r=getIndex(O,n[\"!comparatorPath\"],n[\"!comparatorType\"],getProperty(e,n[\"!comparatorPath\"]));-1===r?O.push(e):O[r]=i(O[r],e,n[\"!arrayElement\"],a,u)}),f(O);case\"overwrite\":return f(t.slice(0));case\"merge\":default:var O=[];return iterateArray(e,function(e,r){O[r]=i(null,e,n[\"!arrayElement\"],a,u)}),iterateArray(t,function(e,r){O[r]=i(O[r],e,n[\"!arrayElement\"],a,u)}),f(O)}case\"object\":default:var v=function(e,t,s){for(;n[t]&&n[t][\"!aliasField\"];){var l=n[t][\"!aliasField\"];n[t][\"!aliasDeprecated\"]&&r.warn('Field \"'+t+'\" is deprecated, please use field \"'+l+'\"'),s=i(e[t],s,n[t],a,u),t=l}n[t]?e[t]=i(e[t],s,n[t],a,u):n[\"!objectProperty\"]?e[t]=i(e[t],s,n[\"!objectProperty\"],a,u):n[\"!objectElement\"]?(r.warn('Template definition \"!objectElement\" is deprecated for adavanced merge, please use \"!objectProperty\"'),e[t]=i(e[t],s,n[\"!objectElement\"],a,u)):e[t]=i(e[t],s,null,a,u)};if(isKindOf(t,Boolean)||isKindOf(t,Number)||isKindOf(t,String)||isKindOf(t,Buffer)||isKindOf(t,Date)||isKindOf(t,RegExp)||isKindOf(t,Function)||isKindOf(t,Error)||isKindOf(t,Symbol)||isNull(e)||isKindOf(e,Boolean)||isKindOf(e,Number)||isKindOf(e,String)||isKindOf(e,Date)||isKindOf(e,Function)||isKindOf(e,Error)||isKindOf(e,Symbol)||isKindOf(e,RegExp)){if(isKindOf(t,Boolean)||isKindOf(t,Number)||isKindOf(t,String)||isKindOf(t,Buffer)||isKindOf(t,Date)||isKindOf(t,RegExp)||isKindOf(t,Function)||isKindOf(t,Error)||isKindOf(t,Symbol))return f(t);if(\"assign\"===n[\"!operation\"]||t&&t.constructor!==Object)return iterateObject(n,function(e,r){\"!\"!==e[0]&&!isNull(r)&&n[e].hasOwnProperty(\"!defaultValue\")&&v(t,e,null)}),f(t);var O=isKindOf(t,Array)&&!g?[]:{};return iterateObject(t,function(e,r){v(O,e,r)}),iterateObject(n,function(e,r){\"!\"!==e[0]&&!isNull(r)&&n[e].hasOwnProperty(\"!defaultValue\")&&isNull(O[e])&&v(O,e,null)}),f(O)}switch(n[\"!operation\"]){case\"assign\":return iterateObject(n,function(e,r){\"!\"!==e[0]&&!isNull(r)&&n[e].hasOwnProperty(\"!defaultValue\")&&isNull(O[e])&&v(t,e,null)}),f(t);case\"overwrite\":var O=isKindOf(t,Array)&&!g?[]:{};return iterateObject(t,function(e,r){v(O,e,r)}),iterateObject(n,function(e,r){\"!\"!==e[0]&&!isNull(r)&&n[e].hasOwnProperty(\"!defaultValue\")&&isNull(O[e])&&v(O,e,null)}),f(O);case\"merge\":default:var O=t;return t.constructor===Object&&(O=isKindOf(t,Array)&&!g?[]:{}),iterateObject(e,function(e,r){v(O,e,r)}),O!==t&&iterateObject(t,function(e,r){v(O,e,r)}),iterateObject(n,function(e,r){\"!\"!==e[0]&&!isNull(r)&&n[e].hasOwnProperty(\"!defaultValue\")&&isNull(O[e])&&v(O,e,null)}),f(O)}}};t=i(t,n,e,{},{})}),t},matchArguments=function(e,r,t){var n={};iterateObject(r,function(e,r){n[e]=advancedMerge({\"!noLogger\":!0,\"!stringFields\":\"acceptsTypes\",\"!arrayFields\":\"acceptsTypes\",acceptTypes:{\"!valueType\":\"array-autoindex\",\"!stringFields\":\"type\",\"!defaultValue\":[\"any\"]},mergeOptions:{\"!valueType\":\"object\"},defaultValue:null},r)});var i=null;if(iterateObject(e,function(e,r){if(r.length===t.length){for(var a={},u=!1,s=0;s<r.length;){var l=n[r[s]],o=!1;l.acceptTypes.forEach(function(e){o||(o=couldBeAcceptedAs(t[s],e))}),o?l.mergeOptions?a[r[s]]=advancedMerge(l.mergeOptions,t[s]):a[r[s]]=t[s]:u=!0,++s}u||(i=a)}}),i)return iterateObject(n,function(e,r){i.hasOwnProperty(e)||(i[e]=advancedMerge(r.mergeOptions,r.defaultValue))}),i;throw new Error(\"Invalid arguments to match with settings\")},getProperty=function(e,r){return r=convert(r,\"string\"),isNull(r)&&(r=\"\"),r=r.replace(/[\\.\\s]+/g,\".\"),r.length>0&&\".\"!==r&&r.split(\".\").forEach(function(r){e=isNull(e)?null:e[r]}),e},getIndex=function(e,r,t,n){r=convert(r,\"string\"),isNull(r)&&(r=\"\");for(var i=comparator.generatePathComparator(r,t,!0),a=0;a<e.length;){if(0===i(e[a],n))return a;++a}return-1},keys=function(e){var r=[];for(var t in e)-1===r.indexOf(t)&&r.push(t);return r.sort(comparator.insensitiveNaturalComparator)},stringHash=function(e){var r,t,n,i=0;if(0==e.length)return i;for(r=0,n=e.length;n>r;r++)t=e.charCodeAt(r),i=(i<<5)-i+t,i|=0;return i};module.exports={deprecated:deprecated,getScriptEngineName:getScriptEngineName,objectize:objectize,isNull:isNull,isKindOf:isKindOf,isArrayLike:isArrayLike,copyAsArray:copyAsArray,iterateArray:iterateArray,iterateObject:iterateObject,formatDate:formatDate,couldBeAcceptedAs:couldBeAcceptedAs,simplify:simplify,convert:convert,merge:merge,advancedMerge:advancedMerge,prepadZero:prepadZero,getStack:getStack,jsonize:jsonize,matchArguments:matchArguments,getProperty:getProperty,getIndex:getIndex,keys:keys,stringHash:stringHash};"}},"/library/lab.common/home.js":{"url":"/library/lab.common/home.js","content":{"encoding":"text","data":"var fs=require(\"fs\"),path=require(\"path\"),Module=require(\"module\"),foundation=require(\"./foundation.js\"),storage=require(\"./storage.js\"),configCaches={},registeredConfigs={},utilHomeDir=null,getConfig=function(e,t,i){var n=getUtilFS(e);!configCaches.hasOwnProperty(e)||t?n.exists(e,function(t){t?n.stat(e,function(t,r){t?(configCaches[e]={},i(configCaches[e])):r.isFile()?n.readFile(e,function(t,n){if(t)configCaches[e]={};else try{configCaches[e]=JSON.parse(n.toString(\"utf8\"))}catch(t){configCaches[e]={}}i(configCaches[e])}):(configCaches[e]={},i(configCaches[e]))}):(configCaches[e]={},i(configCaches[e]))}):i(configCaches[e])},getConfigSync=function(e,t){var i=getUtilFS(e);if(!configCaches.hasOwnProperty(e)||t)try{i.existsSync(e)&&i.statSync(e).isFile()?(console.log(\">>>>>> \"+e),configCaches[e]=JSON.parse(i.readFileSync(e).toString(\"utf8\"))):configCaches[e]={}}catch(n){configCaches[e]={}}return configCaches[e]},getUtilHomeDir=function(e){return e?utilHomeDir?path.resolve(utilHomeDir,e):path.resolve(process.cwd(),e):utilHomeDir?utilHomeDir:process.cwd()},setUtilHomeDir=function(e,t){utilHomeDir=e;var i=0,n=function(){i<registeredConfigs.length?(++i,getUtilConfig(registeredConfigs[i-1],null,n)):t()};n()},getUtilConfig=function(e,t){t||(t=registeredConfigs[e]);var i=foundation.copyAsArray(arguments).slice(2),n=function(){};foundation.isKindOf(i[i.length-1]),Function&&(n=i.pop());var r=path.resolve(storage.getHomeDir(\".mew/conf\"),e+\".json\"),o=path.resolve(getUtilHomeDir(\"conf\"),e+\".json\");getConfig(r,t[\"!noCache\"],function(e){i.unshift(e),r!==o?getConfig(o,t[\"!noCache\"],function(e){i.unshift(e),i.unshift(t),n(foundation.advancedMerge.apply(foundation,i))}):(i.unshift(t),n(foundation.advancedMerge.apply(foundation,i)))})},getUtilConfigSync=function(e,t){t||(t=registeredConfigs[e]);var i=foundation.copyAsArray(arguments).slice(2),n=path.resolve(storage.getHomeDir(\".mew/conf\"),e+\".json\"),r=path.resolve(getUtilHomeDir(\"conf\"),e+\".json\");return i.unshift(getConfigSync(n,t[\"!noCache\"])),n!==r&&i.unshift(getConfigSync(r,t[\"!noCache\"])),i.unshift(t),foundation.advancedMerge.apply(foundation,i)},registerUtilConfig=function(e,t){registeredConfigs.hasOwnProperty(e)||(registeredConfigs[e]=t)},fses={},requires={},registerUtilFS=function(e,t,i){var n=path.resolve(e);fses[n]=t,i&&(requires[n]=i)},getUtilFS=function(e){e=path.resolve(e);var t=null;return Object.keys(fses).forEach(function(i){(e===i||0===e.indexOf(i+path.sep))&&(!t||t.length<i.length)&&(t=i)}),t?fses[t]:fs},requireModule=function(e,t){var i=resolveModule(e,t),n=null;return Object.keys(requires).forEach(function(e){(filePath===e||0===filePath.indexOf(e+path.sep))&&(!n||n.length<e.length)&&(n=e)}),n?requires[n].require(i):void require(\"module\").prototype.require.call(e,i)},resolveModule=function(e,t){if(\".\"===t[0]){var i=path.normalize(path.join(path.dirname(e.id),t)),n=getUtilFS(i);if(n.existsSync(i))return i;throw new Error(\"Module not found \"+t)}if(storage.isRootPath(t)){var n=getUtilFS(i);if(n.existsSync(i))return i;throw new Error(\"Module not found \"+t)}if(-1!==[\"child_process\",\"cluster\",\"crypto\",\"debugger\",\"dgram\",\"dns\",\"domain\",\"events\",\"fs\",\"http\",\"https\",\"module\",\"net\",\"os\",\"path\",\"process\",\"punycode\",\"querystring\",\"readline\",\"repl\",\"smalloc\",\"stream\",\"string_decoder\",\"timers\",\"tls\",\"tty\",\"url\",\"util\",\"vm\",\"zlib\"].indexOf(t))return t;for(var r=e.id;r!==path.dirname(r);){r=path.dirname(r);var i=path.normalize(path.join(r,\"node_modules\",t)),n=getUtilFS(i);if(n.existsSync(i)&&n.statSync(i).isDirectory())return i;if(n.existsSync(i+\".js\")&&n.statSync(i+\".js\").isFile())return i+\".js\";if(n.existsSync(i+\".json\")&&n.statSync(i+\".json\").isFile())return i+\".json\"}var i=path.normalize(path.join(storage.getHomeDir(\".node_modules\"),t)),n=getUtilFS(i);if(n.existsSync(i)&&n.statSync(i).isDirectory())return i;if(n.existsSync(i+\".js\")&&n.statSync(i+\".js\").isFile())return i+\".js\";if(n.existsSync(i+\".json\")&&n.statSync(i+\".json\").isFile())return i+\".json\";var i=path.normalize(path.join(storage.getHomeDir(\".node_libraries\"),t)),n=getUtilFS(i);if(n.existsSync(i)&&n.statSync(i).isDirectory())return i;if(n.existsSync(i+\".js\")&&n.statSync(i+\".js\").isFile())return i+\".js\";if(n.existsSync(i+\".json\")&&n.statSync(i+\".json\").isFile())return i+\".json\";throw new Error(\"Module not found \"+t)},mewJSes={},registerMewJS=function(e,t){mewJSes[e]=foundation.merge(mewJSes[e],t)},getMewJSInfo=function(){var e=null;if(e=foundation.isKindOf(arguments[0],Number)?storage.standardizePath(getFileLine(offset+1,0).split(\":\").slice(0,-1).join(\":\")):arguments[0],\".mew-js\"===path.extname(e)){var t=e.split(\".\").slice(-2)[0];return mewJSes[t]}return null},getFileLine=function(e,t,i){var n=(new Error).stack,r=\"@\";\"V8\"===foundation.getScriptEngineName()&&(++e,r=\"at\"),foundation.isKindOf(t,Number)||(t=3);var t=n.split(\"\\n\")[e+1].split(r).slice(1).join(r).split(path.sep).slice(-t).join(\"/\").split(\":\");return\".jx\"===path.extname(t[0])&&(t[0]=t[0].substring(0,t[0].length-3)),i?t.join(\":\").trim():t.slice(0,t.length-1).join(\":\").trim()};require(\"module\")._extensions[\".mew-js\"]=function(e,t,i){var n=path.normalize(path.join(path.dirname(t),path.basename(t).split(\".\").slice(0,-2).join(\".\")+\".js\")),r=fs.readFileSync(n,\"utf8\");65279===r.charCodeAt(0)&&(r=r.slice(1)),e._compile(r,t,void 0,void 0)};var evaluateScript=function(e,t,i){var n={};for(var r in global)n[r]=global[r];return i?n.require=i:n.require=module.require,n.exports={},n.__filename=t,n.__dirname=path.dirname(t),n.module=n,n.global=global,n.root=root,process.binding(\"evals\").NodeScript.runInThisContext(Module.wrap(e),fileID,!0).call(n.exports,n.exports,n.require,n,n.__filename,n.__dirname,global.setTimeout,global.setInterval,global.process),n};module.exports={getConfig:getConfig,getConfigSync:getConfigSync,getUtilHomeDir:getUtilHomeDir,setUtilHomeDir:setUtilHomeDir,getUtilConfig:getUtilConfig,getUtilConfigSync:getUtilConfigSync,registerUtilConfig:registerUtilConfig,registerUtilFS:registerUtilFS,getUtilFS:getUtilFS,requireModule:requireModule,resolveModule:resolveModule,registerMewJS:registerMewJS,getMewJSInfo:getMewJSInfo,getFileLine:getFileLine,evaluateScript:evaluateScript};"}},"/library/lab.common/logger.js":{"url":"/library/lab.common/logger.js","content":{"encoding":"text","data":"var os=require(\"os\"),path=require(\"path\"),foundation=require(\"./foundation.js\"),home=require(\"./home.js\");home.registerUtilConfig(\"logger\",{\"!noLogger\":!0,logLevel:{\"!valueType\":\"string\",\"!defaultValue\":\"info\"},logStyle:{\"!valueType\":\"string\",\"!defaultValue\":process.isEmbedded?\"none\":\"darwin\"===os.type().toLowerCase()?\"bright\":\"dark\"},supportMultipleLine:{\"!valueType\":\"boolean\",\"!defaultValue\":!0},autorecordFileLine:{\"!valueType\":\"boolean\",\"!defaultValue\":!0},prefix:{\"!valueType\":\"string\",\"!defaultValue\":\"\"}});var styleCodePoints={white:[37,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39],brightBlack:[90,39],brightRed:[91,39],brightGreen:[92,39],brightYellow:[93,39],brightBlue:[94,39],brightMagenta:[95,39],brightCyan:[96,39],brightWhite:[97,39],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},logLevelMap={system:1,assert:2,error:3,dump:4,warn:5,celebr:6,info:7,debug:8},logLevelDisplayMap={system:\"[system]\",assert:\"[assert]\",error:\" [error]\",warn:\"  [warn]\",info:\"  [info]\",celebr:\"[celebr]\",debug:\" [debug]\",dump:\"  [dump]\"},styles={bright:{system:[\"magenta\",\"bold\"],assert:[\"magenta\"],error:[\"red\",\"bold\"],warn:[\"yellow\",\"bold\"],celebr:[\"cyan\",\"bold\"],info:[\"black\"],debug:[\"brightBlack\"],dump:[\"blue\",\"bold\"],line:[\"white\"]},dark:{system:[\"brightMagenta\",\"bold\"],assert:[\"brightMagenta\"],error:[\"brightRed\",\"bold\"],warn:[\"brightYellow\",\"bold\"],celebr:[\"brightGreen\",\"bold\"],info:[\"brightWhite\"],debug:[\"white\"],dump:[\"brightCyan\"],line:[\"brightBlack\"]}},logPlaceholder=null,Logger=function(e){e=home.getUtilConfigSync(\"logger\",null,e),this.logLevel=e.logLevel,this.prefix=e.prefix,[\"logStyle\",\"supportMultipleLine\",\"autorecordFileLine\"].forEach(function(t){Object.defineProperty(this,t,{enumerable:!1,value:e[t]})}.bind(this))};Object.defineProperty(Logger.prototype,\"logWithLevel\",{enumerable:!1,value:function(e,t){if(logLevelMap[this.logLevel]>=logLevelMap[t]){var o=!1;if(this.handler)try{o=this.handler.apply(this,arguments)}catch(r){}o||this.logInConsole.apply(this,arguments)}}}),Object.defineProperty(Logger.prototype,\"logInConsole\",{enumerable:!1,value:function(e,t,o){var r=foundation.formatDate(new Date,\"MM-DD hh:mm:ss.SSS\",!0)+\" \"+logLevelDisplayMap[t].toUpperCase()+\" \";logPlaceholder||(logPlaceholder=r.replace(/./g,function(){return\" \"})),this.prefix&&(r+=this.prefix);var o=arguments[2];arguments.length>3&&(o=foundation.copyAsArray(arguments).slice(2).join(\", \"));var l=null;if(l=null===o?\"null\":void 0===o?\"undefined\":o instanceof Error?o.message+\"\\n\"+foundation.getStack(o):o.constructor===Buffer?o.toString():o.constructor!==String?foundation.jsonize(o):o,l=l.split(\"\\n\").map(function(e,t){return t>0?this.supportMultipleLine?logPlaceholder+e:e:r+e}.bind(this)).join(\"\\n\"),this.autorecordFileLine&&(e=\"(\"+e+\")\"),styles[this.logStyle]){var i=styles[this.logStyle][t];i&&i.forEach(function(e){if(styleCodePoints[e]){var t=\"\u001b[\"+styleCodePoints[e][0]+\"m\",o=\"\u001b[\"+styleCodePoints[e][1]+\"m\";l=t+l+o}});var n=styles[this.logStyle].line;n&&n.forEach(function(t){if(styleCodePoints[t]){var o=\"\u001b[\"+styleCodePoints[t][0]+\"m\",r=\"\u001b[\"+styleCodePoints[t][1]+\"m\";e=o+e+r}})}this.autorecordFileLine&&(l+=\" \"+e),this.output(l)}}),Object.keys(logLevelMap).forEach(function(e){Object.defineProperty(Logger.prototype,e,{enumerable:!1,configurable:!0,writable:!0,value:function(){var t=Array.prototype.slice.call(arguments,0);t.unshift(e),t.unshift(home.getFileLine(1)),this.logWithLevel.apply(this,t)}})}.bind(this)),Object.defineProperty(Logger.prototype,\"assert\",{enumerable:!1,value:function(e){if(!e){var t=Array.prototype.slice.call(arguments,1);t.unshift(\"assert\"),t.unshift(home.getFileLine(1)),this.logWithLevel.apply(this,t)}}}),Object.defineProperty(Logger.prototype,\"dump\",{enumerable:!1,value:function(e,t){t||(t=3),this.prefix||!this.supportMultipleLine?this.logWithLevel.call(this,home.getFileLine(1),\"dump\",\"\\n\"+foundation.jsonize(e,\"\",t)):this.logWithLevel.call(this,home.getFileLine(1),\"dump\",foundation.jsonize(e,\"\",t))}}),Object.defineProperty(Logger.prototype,\"clearScreen\",{enumerable:!1,value:function(){this.output(\"\u001b[2J\")}}),Object.defineProperty(Logger.prototype,\"output\",{enumerable:!1,value:function(e){console.log(e)}}),module.exports=Logger;"}},"/library/lab.common/ruler.js":{"url":"/library/lab.common/ruler.js","content":{"encoding":"text","data":"var foundation=require(\"./foundation.js\"),comparator=require(\"./comparator.js\"),SimpleRuler=function(){};SimpleRuler.prototype.exportRules=function(e){var r=[];return e.rules&&Object.keys(e.rules).forEach(function(i){e.rules[i].forEach(function(e){r.push(e)})}),r},SimpleRuler.prototype.addRules=function(e,r){if(!foundation.isKindOf(r,Array))throw new Error(\"Rule Type Not Supported\");rulesToAdd=r,e?(e.rules||(e.rules={}),e.compiled||(e.compiled={})):e={rules:{},compiled:{}};var i=this;return r.forEach(function(r){var o={};Object.keys(r).forEach(function(e){\"!\"!==e[0]&&(o[e]=r[o])});var n=\"\";Object.keys(o).sort(comparator.naturalComparator).forEach(function(e){if(!foundation.isKindOf(r[e],String)&&!foundation.isKindOf(r[e],Array))throw new Error(\"Hash Key Error : [\"+e+\"]=\"+r[e]);n=n+\"{\"+e+\"=\"+r[e].toString()+\"}\"});var t=foundation.stringHash(n).toString(16),s=i.compileRule(r),a=r[\"!operation\"]||\"merge\";if(e.compiled[t]){switch(a){case\"merge\":e.rules[t].push(r);break;case\"assign\":e.rules[t]=[r];break;case\"clear\":delete e.rules[t]}\"clear\"===a?delete e.compiled[t]:Object.keys(s.fields).forEach(function(r){Object.keys(s.fields[r]).forEach(function(i){switch(a){case\"merge\":s.fields[r][i].forEach(function(o){e.compiled[t][r][i].indexOf(o)<0&&e.compiled[t][r][i].push(o)});break;case\"assign\":e.compiled[t][r][i]=s.fields[r][i]}})})}else e.rules[t]=[r],e.compiled[t]=s.fields}),e},SimpleRuler.prototype.match=function(e,r){if(r&&foundation.isKindOf(r,Object)&&e&&e.compiled){var i=!1;return Object.keys(e.compiled).forEach(function(o){if(!i){var n=e.compiled[o],t=!0;Object.keys(n).forEach(function(e){t&&r[e]&&Object.keys(n[e]).forEach(function(i){if(t)if(foundation.isKindOf(r[e],String))switch(i){case\"not\":t=n[e][i].toString()!==r[e];break;case\"includes\":t=n[e][i].indexOf(r[e])>=0;break;case\"equals\":t=n[e][i].toString()==r[e];break;case\"excludes\":t=n[e][i].indexOf(r[e])<0}else foundation.isKindOf(r[e],Array)?r[e].forEach(function(r){if(t)if(foundation.isKindOf(r,String))switch(i){case\"not\":t=n[e][i].toString()!==r;break;case\"includes\":t=n[e][i].indexOf(r)>=0;break;case\"equals\":t=n[e][i].toString()==r;break;case\"excludes\":t=n[e][i].indexOf(r)<0}else t=!1}):t=!1})}),t&&(i=!0)}}),i}return!0},Object.defineProperty(SimpleRuler.prototype,\"compileRule\",{enumerable:!1,value:function(e){var r=e[\"!data\"];r||(r={});var i={fields:{}},o=!1;if(Object.keys(e).forEach(function(n){if(o=!0,\"!\"!==n[0]){var t,s;if(n.indexOf(\":\")<0?(t=\"equals\",s=n):(t=n.substr(n.lastIndexOf(\":\")+1),s=n.substr(0,n.lastIndexOf(\":\"))),[\"equals\",\"includes\",\"excludes\",\"not\"].indexOf(t)<0)throw new Error(\"Operation not support\");var a=e[n];if(foundation.isKindOf(a,String)){if(\"$\"==a[0]&&(a=r[a.substr(1)],!a))throw new Error(\"No Key Found In Data\")}else{if(!foundation.isKindOf(a,Array))throw new Error(\"Rule Type not supported\");if(!a.length)throw new Error(\"Useless Rule\");for(var f=0;f<a.length;++f){if(!foundation.isKindOf(a[f][0],String))throw new Error(\"Rule Body Type not supported\");if(\"$\"==a[f][0]&&(a[f]=r[a[f].substr(1)],!a[f]))throw new Error(\"No Key Found In Data\")}}i.fields[s]||(i.fields[s]={}),i.fields[s][t]||(i.fields[s][t]=[]),Array.isArray(a)?a.forEach(function(e){i.fields[s][t].indexOf(e)<0&&i.fields[s][t].push(e)}):i.fields[s][t].indexOf(a.toString())<0&&i.fields[s][t].push(a.toString())}else i[n]=e[n]}),!o)throw new Error(\"Useless Rule\");return i}}),module.exports.simple=new SimpleRuler;"}},"/library/lab.common/storage.js":{"url":"/library/lab.common/storage.js","content":{"encoding":"text","data":"var fs=require(\"fs\"),os=require(\"os\"),path=require(\"path\"),getHomeDir=function(e){var t=process.env[\"win32\"==process.platform.toLowerCase()?\"USERPROFILE\":\"HOME\"];return e?path.resolve(t,e):t},getTempDir=function(){var e=os.tmpdir();return e||(e=process.env.TMPDIR),e||(e=process.env.TMP),e||(e=process.env.TEMP),e},makeDirTree=function(e,t,i){var n,i;switch(arguments.length){case 2:arguments[1]instanceof Function?i=arguments[1]:n=arguments[1].toString().split(\",\");break;case 3:default:n=arguments[1],i=arguments[2]}n||(n=[]),i||(i=function(){});var r=function(t){if(t)i(t);else{var a=n.shift();a?makeDir(path.join(e,a),r):i()}};r()},makeDir=function(e){var t,i;switch(arguments.length){case 2:arguments[1]instanceof Function?i=arguments[1]:t=arguments[1];break;case 3:default:t=arguments[1],i=arguments[2]}i||(i=function(){}),e=path.resolve(e);var n=path.normalize(e).split(path.sep);fs.exists(e,function(r){r?i(null):makeDir(n.slice(0,-1).join(path.sep),t,function(n){n&&\"EEXIST\"!==n.code?i(n):fs.mkdir(e,t,function(e){i(e&&\"EEXIST\"!==e.code?e:null)})})})},makeDirSync=function(e,t){e=path.resolve(e);var i=path.normalize(e).split(path.sep);fs.existsSync(e)||(makeDirSync(i.slice(0,-1).join(path.sep),t),fs.mkdirSync(e,t))},copyFileSync=function(e,t){if(!fs.existsSync(e))throw new Error(\"File not found\");fs.statSync(e).isDirectory()?(fs.existsSync(t)?fs.statSync(t).isDirectory()||deleteFileSync(t):makeDirSync(t),fs.readdirSync(e).forEach(function(i){copyFileSync(path.resolve(e,i),path.resolve(t,i))})):(fs.existsSync(t)?deleteFileSync(t):makeDirSync(path.dirname(t)),fs.writeFileSync(t,fs.readFileSync(e)))},copyFile=function(e,t,i){i||(i=function(e){if(e)throw e}),fs.exists(e,function(n){n?fs.stat(e,function(n,r){if(n)i(n);else if(r.isDirectory()){var a=function(){fs.readdir(e,function(n,r){var a=0,s=function(){a<r.length?(++a,copyFile(path.resolve(e,r[a-1]),path.resolve(t,r[a-1]),function(e){e?i(e):s()})):i()};s()})};fs.exists(t,function(e){e?fs.stat(t,function(e,n){n.isDirectory()?a():deleteFile(t,function(e){e?i(e):a()})}):makeDir(t,function(e){e?i(e):a()})})}else fs.exists(t,function(n){var r=function(){var n=fs.createReadStream(e),r=fs.createWriteStream(t);n.pipe(r,{end:!0});var a=!1;n.on(\"error\",function(e){a||(a=!0,i(e))}),r.on(\"error\",function(e){a||(a=!0,i(e))}),r.on(\"finish\",function(){a||(a=!0,i())})};n?deleteFile(t,function(e){e?i(e):r()}):makeDir(path.dirname(t),function(e){e?i(e):r()})})}):i(new Error(\"File not found\"))})},deleteFile=function(e,t){t||(t=function(e){if(e)throw e}),fs.exists(e,function(i){i?fs.stat(e,function(i,n){i?t(i):n.isDirectory()?fs.readdir(e,function(i,n){if(i)t(i);else{var r=0,a=function(){r<n.length?(++r,deleteFile(path.resolve(e,n[r-1]),function(e){e?t(e):a()})):fs.rmdir(e,t)};a()}}):fs.unlink(e,t)}):t()})},deleteFileSync=function(e){fs.existsSync(e)&&(fs.statSync(e).isDirectory()?(fs.readdirSync(e).forEach(function(t){deleteFileSync(path.resolve(e,t))}),fs.rmdirSync(e)):fs.unlinkSync(e))},scanFile=function(e,t,i,n){i||(i=function(e){return!0}),(void 0===t||null===t)&&(t=1);var r=[];fs.exists(e,function(a){a?fs.stat(e,function(a,s){if(a)n(a);else{var o=s.birthtime;o||(o=new Date(Math.min(s.ctime.getTime(),s.atime.getTime())));var c={type:s.isFile()?\"file\":s.isDirectory()?\"directory\":\"unknown\",path:e,mode:s.mode,uid:s.uid,gid:s.gid,createdDate:o,lastModifiedDate:s.mtime,size:s.size},f=i(c);f?s.isDirectory()&&(-1>=t||t>0)?fs.readdir(e,function(a,s){if(a)n(a);else{var o=0,c=function(){if(o<s.length){var a=path.resolve(e,s[o]);++o,scanFile(a,t-1,function(t){return i(t)?(r.push({type:t.type,path:path.relative(e,t.path),mode:t.mode,uid:t.uid,gid:t.gid,createdDate:t.createdDate,lastModifiedDate:t.lastModifiedDate,size:t.size}),!0):!1},function(e){c()})}else n(r)};c()}}):n(s.isFile()?[c]:r):n(r)}}):n(r)})},scanFileSync=function(e,t,i){i||(i=function(e){return!0}),(void 0===t||null===t)&&(t=1);var n=[];if(fs.existsSync(e)){var r=fs.statSync(e),a=r.birthtime;a||(a=new Date(Math.min(r.ctime.getTime(),r.atime.getTime())));var s={type:r.isFile()?\"file\":r.isDirectory()?\"directory\":\"unknown\",path:e,mode:r.mode,uid:r.uid,gid:r.gid,createdDate:a,lastModifiedDate:r.mtime,size:r.size},o=i(s);if(o)if(r.isDirectory()&&(-1===t||t>0)){var n=fs.readdirSync(e);n.forEach(function(r){var a=path.resolve(e,r);scanFileSync(a,t-1,function(t){return n.push({type:t.type,path:path.relative(e,t.path),mode:t.mode,uid:t.uid,gid:t.gid,createdDate:t.createdDate,lastModifiedDate:t.lastModifiedDate,size:t.size}),i(t)})})}else r.isFile()&&n.push(s)}return n},getPathSeparator=function(){return/[\\\\\\/]+/g},ensurePosixPath=function(e){return resolvePath(e).replace(getPathSeparator(),\"/\")},standardizePath=function(e){return resolvePath(e).replace(getPathSeparator(),path.sep)},resolvePath=function(){for(var e=[],t=0;t<arguments.length;){var i=arguments[t],n=i.split(getPathSeparator());if(isRootPath(i)){var r=/^[a-z]:$/;r.test(e[0])&&!r.test(n[0])?(e=[e[0]],n=n.splice(1)):e=[]}n.forEach(function(i){switch(i){case\"\":0===t&&e.push(i);break;case\".\":break;case\"..\":e.length>0&&\"..\"!==e[e.length-1]&&\"\"!==e[e.length-1]?e.pop():e.push(i);break;default:e.push(i)}}),++t}return e.join(path.sep)},isRootPath=function(e){return/^([a-z]:)?[\\\\\\/]/gim.test(e)},isJustRootPath=function(e){return/^([a-z]:)?[\\\\\\/]$/gim.test(e)};module.exports={makeDir:makeDir,makeDirSync:makeDirSync,makeDirTree:makeDirTree,copyFile:copyFile,copyFileSync:copyFileSync,deleteFile:deleteFile,deleteFileSync:deleteFileSync,scanFile:scanFile,scanFileSync:scanFileSync,getHomeDir:getHomeDir,getTempDir:getTempDir,getPathSeparator:getPathSeparator,standardizePath:standardizePath,ensurePosixPath:ensurePosixPath,resolvePath:resolvePath,isRootPath:isRootPath,isJustRootPath:isJustRootPath};"}},"/library/lab.common/template.js":{"url":"/library/lab.common/template.js","content":{"encoding":"text","data":"var finalTemplate=function(e,t,n){if(n||(n=\"text/plain\"),n.constructor==String&&(n={parser:n}),n.parser||(n.parser=\"text/plain\"),t){if(!n.parametersMutable){var r={};for(var a in t)r[a]=t[a];t=r}}else t={};return finalTemplate.parsers[n.parser]?finalTemplate.parsers[n.parser](e,t,n):null};finalTemplate.operators={},finalTemplate.operatorQueue=[[\"right\",\"!\",\"~\"],[\"left\",\"*\",\"/\",\"%\"],[\"left\",\"+\",\"-\"],[\"left\",\"<<\",\">>\"],[\"left\",\"<\",\">\",\"<=\",\">=\"],[\"left\",\"==\",\"!=\"],[\"left\",\"&\"],[\"left\",\"^\"],[\"left\",\"|\"],[\"left\",\"&&\"],[\"left\",\"||\"],[\"right\",\";\"]],finalTemplate.functors={},finalTemplate.parsers={},finalTemplate.lexer={},finalTemplate.Operator=function(e,t,n,r,a){return this.call=function(o,l,i,u){var s=[].slice.call(arguments,4),c={};for(var f in t)c[f]=t[f];if(c.$n)for(var p=1;p<=c.$n;)delete c[\"$\"+p],++p;return r.forEach(function(e,t){c[e]=s[t]}),c.$0=this,c.$n=s.length,c.$a=s,c[\"^\"]=t,s.forEach(function(e,t){c[\"$\"+(t+1)]=e}),finalTemplate.run(e,a,c,n)},this},finalTemplate.lexer.stringify=function(e){\"blk\"!=e.type&&(e=[e],e.type=\"blk\",e.operator=\"\",e.index=e[0].index);var t={\"(\":\")\",\"[\":\"]\",\"{\":\"}\"},n=t[e.operator];n||(n=e.operator);var r=[];return r.push(e.operator),e.forEach(function(e){if(!e)return void r.push(\"\");switch(e.type){case\"qot\":r.push('\"'+e.content.replace(/\\\\/gim,\"\\\\\\\\\").replace(/\\n/gim,\"\\\\n\").replace(/\"/gim,'\\\\\"')+'\"');break;case\"num\":case\"sym\":case\"opr\":r.push(e.content);break;case\"fnc\":case\"opc\":r.push(e.content),r.push(\"(\");var t=[];e.arguments.forEach(function(e){t.push(finalTemplate.lexer.stringify(e))}),r.push(t.join(\",\")),r.push(\")\");break;case\"reg\":r.push(\"#\"+e.content.source.replace(/#/gim,\"\\\\#\")+\"#\");break;case\"blk\":r.push(finalTemplate.lexer.stringify(e))}}),r.push(n),r.join(\"\")},finalTemplate.lexer.getSymbol=function(e,t){for(;t<e.length&&-1!=[9,10,13,32].indexOf(e.charCodeAt(t));)++t;if(!(t<e.length))return{type:\"eot\",content:null,index:e.length};var n=e.charCodeAt(t);switch(n){case 34:case 39:for(var r=[],a=0,o=t+1;o<e.length&&(a=e.charCodeAt(o))!=n;)if(92==a){var l=e.charCodeAt(o+1);switch(l){case 110:r.push(\"\\n\");break;case 92:r.push(\"\\\\\");break;case 34:r.push('\"');break;case 39:r.push(\"'\");break;default:return{type:\"err\",description:\"Invalid escaped character\",content:null,index:o+1}}o+=2}else r.push(e[o]),++o;return o<e.length?{type:\"qot\",content:r.join(\"\"),index:t,next:o+1}:{type:\"err\",description:\"Quotation not be terminated\",content:null,index:e.length};case 35:for(var r=[],a=0,o=t+1;o<e.length&&35!=(a=e.charCodeAt(o));)if(92==a){var l=e.charCodeAt(o+1);r.push(35==l?\"#\":String.fromCharCode(92,l)),o+=2}else r.push(e[o]),++o;return o<e.length?{type:\"reg\",content:new RegExp(r.join(\"\"),\"gm\"),index:t,next:o+1}:{type:\"err\",description:\"Regular expression not be terminated\",content:null,index:e.length};case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:for(var i=!1,a=0,o=t;o<e.length&&-1!=[48,49,50,51,52,53,54,55,56,57,46].indexOf(a=e.charCodeAt(o));){if(46==a){if(i)return{type:\"err\",description:\"Two dots have been found in number\",content:null,index:o};i=!0}++o}var u=e.substring(t,o);return i?{type:\"num\",content:parseFloat(u),index:t,next:o}:{type:\"num\",content:parseInt(u),index:t,next:o};case 46:case 43:case 45:case 61:case 42:case 47:case 38:case 33:case 94:case 37:case 126:case 60:case 62:case 44:case 63:case 58:case 59:case 124:case 40:case 41:case 91:case 93:case 123:case 125:var s=[\"&&\",\"||\",\">=\",\"<=\",\"!=\",\"==\",\">>\",\"<<\"];return t+1<e.length&&-1!=s.indexOf(e[t]+e[t+1])?{type:\"opr\",content:e[t]+e[t+1],index:t,next:t+2}:{type:\"opr\",content:e[t],index:t,next:t+1};default:for(var a=0,o=t;o<e.length&&-1==[9,10,13,32,34,39,35,46,43,45,61,42,47,38,33,94,37,126,60,62,44,63,58,59,124,40,41,91,93,123,125].indexOf(a=e.charCodeAt(o));)++o;var u=e.substring(t,o);return{type:\"sym\",content:u,index:t,next:o}}},finalTemplate.lexer.convertCharacter=function(e){for(var t=[],n=0;n<e.length;){var r=finalTemplate.lexer.getSymbol(e,n);switch(r.type){case\"err\":var a=r.description+\". \";throw a+=\"Code: \"+e.substring(Math.max(r.index-10,0),Math.min(r.index+10,e.length)),new Error(a);case\"eot\":n=e.length;break;case\"num\":case\"opr\":case\"sym\":case\"qot\":case\"reg\":default:t.push(r),n=r.next}}return t},finalTemplate.lexer.convertBracket=function(e,t){var n=[];n.type=\"blk\",n.operator=\"\",n.symbol=t[0];var r=n;return t.forEach(function(n){if(\"opr\"==n.type)switch(n.content){case\"(\":case\"[\":case\"{\":var a=[];a.superqueue=r,a.type=\"blk\",a.operator=n.content,a.symbol=n,a.index=n.index,r.push(a),r=a;break;case\")\":case\"]\":case\"}\":if(!r.superqueue){var o=r.symbol;r.length>0&&(o=r[r.length-1],\"blk\"==o.type&&(o=o.symbol)),o||(o=t[t.length-1]);var l=e.substring(Math.max(o.index-10,0),Math.min(o.index+10,e.length));throw new Error(\"No close brackets found. Code: \"+l)}if(\"\"==r.operator||\"(\"!=r.operator&&\")\"==n.content||\"[\"!=r.operator&&\"]\"==n.content||\"{\"!=r.operator&&\"}\"==n.content){var o=r.symbol;r.length>0&&(o=r[r.length-1],\"blk\"==o.type&&(o=o.symbol)),o||(o=t[t.length-1]);var l=e.substring(Math.max(o.index-10,0),Math.min(o.index+10,e.length));throw new Error(\"Brackets not matched. Code: \"+l)}r=r.superqueue;break;default:r.push(n)}else r.push(n)}),n},finalTemplate.lexer.convertSugar=function(e,t){var n=[];n.symbol=t.symbol,n.type=t.type,n.operator=t.operator;var r=0;return t.forEach(function(a,o){if(!(r>o))switch(a.type){case\"opr\":if(\".\"==a.content){for(var l=[];n.length>0&&\"opr\"!=n[n.length-1].type;)l.unshift(n.pop());var i=t[o+1];n.push({type:\"ops\",content:\".\",index:a.index,next:a.next});var u=[];if(u.symbol=a,u.type=\"blk\",u.operator=\"(\",l.forEach(function(e){u.push(e)}),u.push({type:\"opr\",content:\",\",index:a.index,next:a.next}),\"sym\"!=i.type){var s=e.substring(Math.max(i.index-10,0),Math.min(i.index+10,e.length));throw new Error(\"Invalid usage of dot on syntax. Code: \"+s)}u.push({type:\"qot\",content:i.content,index:i.index,next:i.next}),n.push(u),r=o+2}else\";\"==a.content?o<t.length-1&&n.push(a):n.push(a);break;case\"blk\":if(\"[\"==a.operator){for(var l=[];n.length>0&&\"opr\"!=n[n.length-1].type;)l.unshift(n.pop());var i=finalTemplate.lexer.convertSugar(e,a);n.push({type:\"ops\",content:l.length>0?\".\":\"#\",index:a.index,next:a.next});var u=[];u.symbol=a,u.type=\"blk\",u.operator=\"(\",l.length>0&&(l.forEach(function(e){u.push(e)}),u.push({type:\"opr\",content:\",\",index:a.index,next:a.next})),i.forEach(function(e){u.push(e)}),n.push(u)}else if(\"{\"==a.operator){var c=a.filter(function(e){return\"opr\"==e.type&&\":\"==e.content}).length>0,f=a.filter(function(e){return\"opr\"==e.type&&\"?\"==e.content}).length>0;if(c&&f){var s=e.substring(Math.max(a.index-10,0),Math.min(a.index+10,e.length));throw new Error(\"Undetermined definition of object or switch. Code: \"+s)}if(a.length>0&&!c&&!f){var i=finalTemplate.lexer.convertSugar(e,a);n.push({type:\"ops\",content:\"$\",index:a.index,next:a.next});var u=[];if(u.symbol=a,u.type=\"blk\",u.operator=\"(\",u.index=a.index,1==i.length&&\"opr\"==i[0].type){var p=function(e,t){return{type:e,content:t,index:i[0].index,next:i[0].next}};switch(i[0].content){case\"-\":u.push(p(\"sym\",\"if\"));var h=[];h.symbol=i[0],h.type=\"blk\",h.operator=\"(\",h.push(p(\"sym\",\"$n\")),h.push(p(\"opr\",\"==\")),h.push(p(\"num\",1)),h.push(p(\"opr\",\",\")),h.push(p(\"opr\",i[0].content)),h.push(p(\"sym\",\"$1\")),h.push(p(\"opr\",\",\")),h.push(p(\"sym\",\"$1\")),h.push(p(\"opr\",i[0].content)),h.push(p(\"sym\",\"$2\")),u.push(h);break;case\"~\":case\"!\":u.push(p(\"opr\",i[0].content)),u.push(p(\"sym\",\"$1\"));break;default:u.push(p(\"sym\",\"$1\")),u.push(p(\"opr\",i[0].content)),u.push(p(\"sym\",\"$2\"))}}else i.forEach(function(e){u.push(e)});n.push(u)}else if(2==a.length&&f&&\"sym\"==a[0].type){var p=function(e,t){return{type:e,content:t,index:a[0].index,next:a[0].next}};n.push({type:\"ops\",content:\"$\",index:a.index,next:a.next});var u=[];u.symbol=a,u.type=\"blk\",u.operator=\"(\",u.index=a.index,u.push(p(\"sym\",\"execute\"));var h=[];h.symbol=a,h.type=\"blk\",h.operator=\"(\",h.index=a.index,h.push(p(\"qot\",a[0].content)),h.push(p(\"opr\",\",\")),h.push(p(\"sym\",\"$a\")),u.push(h),n.push(u)}else{var i=finalTemplate.lexer.convertSugar(e,a);n.push({type:\"ops\",content:c?\"@\":\"?\",index:a.index,next:a.next});var u=[];u.symbol=a,u.type=\"blk\",u.operator=\"(\";var m=c?\":\":\"?\";if(i.forEach(function(t){if(\"opr\"!=t.type||\",\"!=t.content&&\":\"!=t.content&&\"?\"!=t.content)u.push(t);else{if(t.content!=m){var n=e.substring(Math.max(t.index-10,0),Math.min(t.index+10,e.length));throw new Error(\"Invalid inline object syntax. Code: \"+n)}u.push({type:\"opr\",content:\",\",index:t.index,next:t.next}),m=\",\"==t.content?c?\":\":\"?\":\",\"}}),\"opr\"==i[i.length-1].type&&(\"?\"==i[i.length-1].content||\":\"==i[i.length-1].content)){var s=e.substring(Math.max(i[i.length-1].index-10,0),Math.min(i[i.length-1].index+10,e.length));throw new Error(\"Invalid inline object syntax. Code: \"+s)}n.push(u)}}else n.push(finalTemplate.lexer.convertSugar(e,a));break;case\"num\":case\"sym\":case\"qot\":case\"reg\":default:n.push(a)}}),n},finalTemplate.lexer.convertCall=function(e,t){var n=[];n.symbol=t.symbol,n.type=t.type,n.operator=t.operator;var r=0;return t.forEach(function(t,a){if(!(r>a))switch(t.type){case\"blk\":if(\"(\"==t.operator)if(n.length>0&&(\"sym\"==n[n.length-1].type||\"ops\"==n[n.length-1].type)){var o=n.pop(),l=[],i=[];i.type=\"blk\",i.operator=\"\",i.symbol=t,l.push(i),t.forEach(function(n){if(\"opr\"==n.type&&\",\"==n.content){if(0==l[l.length-1].length){var r=e.substring(Math.max(n.index-10,0),Math.min(n.index+10,e.length));throw new Error(\"No argument found. Code: \"+r)}var a=[];a.type=\"blk\",a.operator=\"\",a.symbol=t,l.push(a)}else l[l.length-1].push(n)});for(var u=0;u<l.length;)l[u]=finalTemplate.lexer.convertCall(e,l[u]),++u;1==l.length&&0==l[0].length&&(l=[]),n.push({type:\"sym\"==o.type?\"fnc\":\"opc\",content:o.content,arguments:l,symbol:o,index:o.index,next:o.next})}else n.push(finalTemplate.lexer.convertCall(e,t));else n.push(finalTemplate.lexer.convertCall(e,t));break;case\"opr\":case\"ops\":case\"num\":case\"sym\":case\"qot\":case\"reg\":default:n.push(t)}}),n},finalTemplate.lexer.convertOperator=function(e,t){if(t.operatorNo)return t;var n=t.slice(0);n.symbol=t.symbol,n.type=t.type,n.operator=t.operator,n.operatorNo=!0;for(var r=0;r<finalTemplate.operatorQueue.length;){for(var a=\"left\"==finalTemplate.operatorQueue[r][0],o=a?0:n.length-1;o<n.length&&o>=0;){if(\"opr\"==n[o].type&&finalTemplate.operatorQueue[r].indexOf(n[o].content)>0)if(\"!\"==n[o].content||\"~\"==n[o].content||0==o&&\"-\"==n[o].content){if(o+1>=n.length){var l=e.substring(Math.max(n[o].index-10,0),Math.min(n[o].index+10,e.length));throw new Error('No operatee found for operator \"'+n[o].content+'\". Code: '+l)}var i=[],u=[];u.type=\"blk\",u.operator=\"\",u.symbol=n[o],i.push(u),u.push(n[o+1]);for(var s=o,c=1;\"opr\"==n[s+c].type;){if(s+c>=n.length){var l=e.substring(Math.max(n[s+c].index-10,0),Math.min(n[s+c].index+10,e.length));throw new Error('No operatee found for operator \"'+n[s+c].content+'\". Code: '+l)}u.push(n[s+c+1]),a?(++o,++c):(--o,--c)}n.splice(s,1+c,{type:\"opc\",content:n[s].content,arguments:i,symbol:n[s],index:n[s].index,next:n[s].next})}else{var i=[];if(o+1>=n.length||1>o){var l=e.substring(Math.max(n[o].index-10,0),Math.min(n[o].index+10,e.length));throw new Error('No operatee found for operator \"'+n[o].content+'\". Code: '+l)}var u=[];u.type=\"blk\",u.operator=\"\",u.symbol=n[o],i.push(u),u.push(n[o-1]),u=[],u.type=\"blk\",u.operator=\"\",u.symbol=n[o],i.push(u),u.push(n[o+1]);for(var s=o,c=1;\"opr\"==n[s+c].type;){if(s+c>=n.length){var l=e.substring(Math.max(n[s+c].index-10,0),Math.min(n[s+c].index+10,e.length));throw new Error('No operatee found for operator \"'+n[s+c].content+'\". Code: '+l)}u.push(n[s+c+1]),a?++o:--o,++c}n.splice(s-1,c+2,{type:\"opc\",content:n[s].content,arguments:i,symbol:n[s],index:n[s].index,next:n[s].next}),a&&--o}a?++o:--o}++r}var f=[];return f.symbol=t.symbol,f.type=t.type,f.operator=t.operator,f.operatorNo=!0,n.forEach(function(t){switch(t.type){case\"blk\":f.push(finalTemplate.lexer.convertOperator(e,t));break;case\"fnc\":case\"opc\":var n=[];t.arguments.forEach(function(t){n.push(finalTemplate.lexer.convertOperator(e,t))}),f.push({type:t.type,content:t.content,arguments:n,symbol:t.symbol,index:t.index,next:t.next});break;case\"opr\":case\"ops\":case\"num\":case\"sym\":case\"qot\":case\"reg\":default:f.push(t)}}),f},finalTemplate.lexer.convertQueue=function(e,t){if(!t||0==t.length)return null;if(t.length>1){var n=e.substring(Math.max(t[0].index-10,0),Math.min(t[0].index+10,e.length));throw console.log(t),new Error(\"Queue could not be simplfied to pure function calls. Code: \"+n)}switch(t[0].type){case\"fnc\":case\"opc\":var r=[];return t[0].arguments.forEach(function(t){r.push(finalTemplate.lexer.convertQueue(e,t))}),{type:t[0].type,content:t[0].content,arguments:r,index:t[0].index};case\"blk\":return finalTemplate.lexer.convertQueue(e,t[0]);case\"sym\":case\"qot\":case\"reg\":case\"num\":return t[0];case\"opr\":case\"ops\":default:var n=e.substring(Math.max(t[0].index-10,0),Math.min(t[0].index+10,e.length));throw new Error(\"Queue could not be simplfied to pure function calls. Code: \"+n)}},finalTemplate.run=function(e,t,n,r){switch(t.type){case\"fnc\":case\"opc\":var a=null;if(\"fnc\"==t.type?(r.functors&&(a=r.functors[t.content]),a||(a=finalTemplate.functors[t.content])):a=finalTemplate.operators[t.content],(a===Function||a===eval)&&(a=null),!a){var o=e.substring(Math.max(t.index-20,0),Math.min(t.index+20,e.length));throw new Error(\"Function or operator definition not found: \"+o)}var l=[];t.arguments.forEach(function(t){var a=null,o=!1;l.push(function(){return o||(a=finalTemplate.run(e,t,n,r),o=!0),a})}),a.lazy||(l=l.map(function(e){return e()}));var i=[e,t,n,r];l.forEach(function(e){i.push(e)});var u=null;return u=a.apply(null,i);case\"sym\":switch(t.content){case\"true\":return!0;case\"false\":return!1;case\"null\":return null;case\"undefined\":return void 0;case\"nan\":return NaN;case\"infinity\":return 1/0;default:return n[t.content]}case\"num\":case\"qot\":case\"reg\":return t.content;case\"opr\":case\"ops\":default:var o=e.content.substring(Math.max(t.index-10,0),Math.min(t.index+10,e.length));throw new Error(\"Invalid code: \"+o)}},finalTemplate.execute=function(e,t,n){if(t){if(!n.parametersMutable){var r={};for(var a in t)r[a]=t[a];t=r}}else t={};n||(n={}),n.log&&console.log(\"Code:   \"+e);var o=finalTemplate.lexer.convertCharacter(e);if(0==o.length)return null;var l=finalTemplate.lexer.convertBracket(e,o),l=finalTemplate.lexer.convertSugar(e,l),l=finalTemplate.lexer.convertCall(e,l),l=finalTemplate.lexer.convertOperator(e,l);n.log&&console.log(\"Queue:  \"+finalTemplate.lexer.stringify(l));var i=finalTemplate.lexer.convertQueue(e,l);n.log&&console.log(\"Call:   \"+finalTemplate.lexer.stringify(i));var u=finalTemplate.run(e,i,t,n);return n.log&&console.log(\"Result: \"+u),u},finalTemplate.compile=function(e,t){t||(t={}),t.log&&console.log(\"Code:   \"+e);var n=finalTemplate.lexer.convertCharacter(e);if(0==n.length)return null;var r=finalTemplate.lexer.convertBracket(e,n),r=finalTemplate.lexer.convertSugar(e,r),r=finalTemplate.lexer.convertCall(e,r),r=finalTemplate.lexer.convertOperator(e,r);t.log&&console.log(\"Queue:  \"+finalTemplate.lexer.stringify(r));var a=finalTemplate.lexer.convertQueue(e,r);return t.log&&console.log(\"Call:   \"+finalTemplate.lexer.stringify(a)),a},finalTemplate.operators[\".\"]=function(e,t,n,r,a,o){if(null===a||void 0===a)return null;var l=a[o];return r.functionAvailable?(l===Function||l===eval)&&(l=null):l&&l.constructor==Function&&(l=null),l},finalTemplate.operators[\"*\"]=function(e,t,n,r,a,o){return a*o},finalTemplate.operators[\"/\"]=function(e,t,n,r,a,o){return a/o},finalTemplate.operators[\"%\"]=function(e,t,n,r,a,o){return a%o},finalTemplate.operators[\"+\"]=function(e,t,n,r,a,o){return a+o},finalTemplate.operators[\"-\"]=function(e,t,n,r,a,o){return 5==arguments.length?-a:a-o},finalTemplate.operators[\"!\"]=function(e,t,n,r,a){return!a},finalTemplate.operators[\"~\"]=function(e,t,n,r,a){return~a},finalTemplate.operators[\"&\"]=function(e,t,n,r,a,o){return a()&o()},finalTemplate.operators[\"|\"]=function(e,t,n,r,a,o){return a()|o()},finalTemplate.operators[\"^\"]=function(e,t,n,r,a,o){return a()^o()},finalTemplate.operators[\"&&\"]=function(e,t,n,r,a,o){return a()&&o()},finalTemplate.operators[\"||\"]=function(e,t,n,r,a,o){return a()||o()},finalTemplate.operators[\">\"]=function(e,t,n,r,a,o){return a>o},finalTemplate.operators[\"<\"]=function(e,t,n,r,a,o){return o>a},finalTemplate.operators[\">=\"]=function(e,t,n,r,a,o){return a>=o},finalTemplate.operators[\"<=\"]=function(e,t,n,r,a,o){return o>=a},finalTemplate.operators[\">>\"]=function(e,t,n,r,a,o){return a>>o},finalTemplate.operators[\"<<\"]=function(e,t,n,r,a,o){return a<<o},finalTemplate.operators[\"==\"]=function(e,t,n,r,a,o){return a===o},finalTemplate.operators[\"!=\"]=function(e,t,n,r,a,o){return a!==o},finalTemplate.operators[\"#\"]=function(e,t,n,r){return[].slice.call(arguments,4)},finalTemplate.operators[\"@\"]=function(e,t,n,r){var a=[].slice.call(arguments,4);if(a.length%2==1){var o=e.substring(Math.max(t.arguments[t.arguments.length-1].index-10,0),Math.min(t.arguments[t.arguments.length-1].index+10,e.length));throw new Error(\"Invalid inline object syntax. Code: \"+o)}for(var l={},i=0;i<a.length;)l[a[i]]=a[i+1],i+=2;return l},finalTemplate.operators.$=function(e,t,n,r){var a=t.arguments.slice(0,t.arguments.length-1).map(function(t){if(\"sym\"!=t.type){var n=e.substring(Math.max(t.index-10,0),Math.min(t.index+10,e.length));throw new Error(\"Invalid argument definition. Code: \"+n)}return t.content}),o=t.arguments[t.arguments.length-1];return new finalTemplate.Operator(e,n,r,a,o)},finalTemplate.operators[\";\"]=function(e,t,n,r,a,o){var l=a();return n.$x=l,o()},finalTemplate.operators[\"?\"]=function(e,t,n,r){for(var a=n.$x,o=[].slice.call(arguments,4),l=0;l<o.length;){if(l==o.length-1)return o[l]();var i=o[l]();if(i===a)return o[l+1]();l+=2}return null},finalTemplate.operators[\"&\"].lazy=!0,finalTemplate.operators[\"|\"].lazy=!0,finalTemplate.operators[\"^\"].lazy=!0,finalTemplate.operators[\"&&\"].lazy=!0,finalTemplate.operators[\"||\"].lazy=!0,finalTemplate.operators.$.lazy=!0,finalTemplate.operators[\";\"].lazy=!0,finalTemplate.operators[\"?\"].lazy=!0,finalTemplate.functors.call=function(e,t,n,r,a){return finalTemplate.functors.execute(e,t,n,r,a,[].slice.call(arguments,5))},finalTemplate.functors.execute=function(e,t,n,r,a,o){if(!a)return null;o||(o=[]);var l=o.slice();return l.unshift(r),l.unshift(n),l.unshift(t),l.unshift(e),a.constructor==finalTemplate.Operator?a.call.apply(a,l):a.constructor==String&&finalTemplate.functors[a]?finalTemplate.functors[a].apply(this,l):null},finalTemplate.functors.echo=function(e,t,n,r,a){return r&&r.echo?r.echo(a):console.log(\"Echo:   \"+a),a},finalTemplate.functors[\"if\"]=function(e,t,n,r,a,o,l){return a()?o():l()},finalTemplate.functors[\"default\"]=function(e,t,n,r,a,o){return a()?a():o()},finalTemplate.functors.round=function(e,t,n,r,a){return Math.round(a)},finalTemplate.functors.floor=function(e,t,n,r,a){return Math.floor(a)},finalTemplate.functors.ceil=function(e,t,n,r,a){return Math.ceil(a)},finalTemplate.functors.min=function(e,t,n,r){var a=[].slice.call(arguments,4);return Math.min.apply(Math,a)},finalTemplate.functors.max=function(e,t,n,r){var a=[].slice.call(arguments,4);return Math.max.apply(Math,a)},finalTemplate.functors.trim=function(e,t,n,r,a){return a.trim()},finalTemplate.functors.split=function(e,t,n,r,a,o){return a.split(o)},finalTemplate.functors.join=function(e,t,n,r,a,o){return a.join(o)},finalTemplate.functors.slice=function(e,t,n,r,a,o,l){return a.slice(o,l)},finalTemplate.functors.search=function(e,t,n,r,a,o,l){return a.indexOf(o,l)},finalTemplate.functors.string=function(e,t,n,r){var a=[].slice.call(arguments,4);return String.fromCharCode.apply(String,a)},finalTemplate.functors.code=function(e,t,n,r,a){for(var o=[],l=0;l<a.length;)o.push(a.charCodeAt(l)),++l;return o},finalTemplate.functors.lowerCase=function(e,t,n,r,a){return a.toLocaleLowerCase()},finalTemplate.functors.upperCase=function(e,t,n,r,a){return a.toLocaleUpperCase()},finalTemplate.functors.date=function(e,t,n,r,a,o,l,i,u,s,c){if(4==arguments.length)return new Date;if(5==arguments.length)return new Date(/^(\\-?)[0-9]+(\\.[0-9]+)?$/.test(a)?1e3*a:a);if(7==arguments.length){var f=new Date(a,o-1,l);return f.setFullYear(a),f}if(10==arguments.length){var f=new Date(a,o-1,l,i,u,s);return f.setFullYear(a),f}if(11==arguments.length){var f=new Date(a,o-1,l,i,u,s,c);return f.setFullYear(a),f}return null},finalTemplate.functors.timeunit=function(e,t,n,r,a,o){switch(o){case\"year\":return a.getFullYear();case\"month\":return a.getMonth()+1;case\"date\":return a.getDate();case\"day\":return a.getDay();case\"hour\":return a.getHours();case\"minute\":return a.getMinutes();case\"second\":return a.getSeconds();case\"millisecond\":return a.getMilliseconds();case\"timestamp\":return a.getTime()/1e3;default:return null}},finalTemplate.functors.replace=function(e,t,n,r,a,o,l,i){return a.replace(o,l,i)},finalTemplate.functors.match=function(e,t,n,r,a,o){return o.test(a)},finalTemplate.functors.format=function(e,t,n,r,e,a){for(var o=function(e,t){for(e+=\"\";e.length<t;)e=\"0\"+e;return e},l=[],i=0;i<e.length;)switch(e[i]){case\"Y\":\"Y\"==e[i+1]?\"Y\"==e[i+2]&&\"Y\"==e[i+3]?(l.push(o(a.getFullYear(),4)),i+=4):(l.push(o(a.getFullYear()%100,2)),i+=2):(l.push(a.getFullYear()+\"\"),++i);break;case\"M\":\"M\"==e[i+1]?(l.push(o(a.getMonth()+1,2)),i+=2):(l.push(a.getMonth()+1+\"\"),++i);break;case\"D\":\"D\"==e[i+1]?(l.push(o(a.getDate(),2)),i+=2):(l.push(a.getDate()+\"\"),++i);break;case\"h\":\"h\"==e[i+1]?(l.push(o(a.getHours(),2)),i+=2):(l.push(a.getHours()+\"\"),++i);break;case\"m\":\"m\"==e[i+1]?(l.push(o(a.getMinutes(),2)),i+=2):(l.push(a.getMinutes()+\"\"),++i);break;case\"s\":\"s\"==e[i+1]?(l.push(o(a.getSeconds(),2)),i+=2):(l.push(a.getSeconds()+\"\"),++i);break;case\"S\":\"S\"==e[i+1]&&\"S\"==e[i+2]?(l.push(o(a.getMilliseconds(),3)),i+=3):(l.push(a.getMilliseconds()+\"\"),++i);break;case'\"':case\"'\":for(var u=1;e[i+u]!=e[i]&&i+u<e.length;)\"\\\\\"==e[i+u]?(l.push(e[i+u+1]),u+=2):(l.push(e[i+u]),++u);i+=u+1;break;default:l.push(e[i]),++i}return l.join(\"\")},finalTemplate.functors.parse=function(e,t,n,r,a){return-1!=a.indexOf(\".\")?parseFloat(a):parseInt(a)},finalTemplate.functors.fixed=function(e,t,n,r,a,o){return a.toFixed(o)},finalTemplate.functors.precision=function(e,t,n,r,a,o){return a.toPrecision(o)},finalTemplate.functors.filter=function(e,t,n,r,a,o){return a.filter(function(a,l,i){return o.call(e,t,n,r,a,l,i)})},finalTemplate.functors.map=function(e,t,n,r,a,o){return a.map(function(a,l,i){return o.call(e,t,n,r,a,l,i)})},finalTemplate.functors.count=function(e,t,n,r,a,o){return o?a.filter(function(a,l,i){return o.call(e,t,n,r,a,l,i)}).length:a.length},finalTemplate.functors.sort=function(e,t,n,r,a,o){return a=a.slice(0),o?a.sort(function(a,l){return o.call(e,t,n,r,a,l)}):a.sort()},finalTemplate.functors.fold=function(e,t,n,r,a,o,l){return a.forEach(function(a,i,u){o=l.call(e,t,n,r,o,a,i,u)}),o},finalTemplate.functors.log=function(e,t,n,r,a,o){return 5==arguments.length?Math.log(a):Math.log(a)/Math.log(o)},finalTemplate.functors.power=function(e,t,n,r,a,o){return 5==arguments.length?Math.pow(Math.E,arguments[4]):Math.pow(a,o)},finalTemplate.functors.sqrt=function(e,t,n,r,a){return Math.sqrt(a)},finalTemplate.functors.cbrt=function(e,t,n,r,a){return Math.cbrt(a)},finalTemplate.functors.sin=function(e,t,n,r,a){return Math.sin(a)},finalTemplate.functors.cos=function(e,t,n,r,a){return Math.cos(a)},finalTemplate.functors.tan=function(e,t,n,r,a){return Math.tan(a)},finalTemplate.functors.asin=function(e,t,n,r,a){return Math.asin(a)},finalTemplate.functors.acos=function(e,t,n,r,a){return Math.acos(a)},finalTemplate.functors.atan=function(e,t,n,r,a){return Math.atan(a)},finalTemplate.functors.angle=function(e,t,n,r,a,o){return Math.atan2(o,a)},finalTemplate.functors.sinh=function(e,t,n,r,a){return Math.sinh(a)},finalTemplate.functors.cosh=function(e,t,n,r,a){return Math.cosh(a)},finalTemplate.functors.tanh=function(e,t,n,r,a){return Math.tanh(a)},finalTemplate.functors.asinh=function(e,t,n,r,a){return Math.asinh(a)},finalTemplate.functors.acosh=function(e,t,n,r,a){return Math.acosh(a)},finalTemplate.functors.atanh=function(e,t,n,r,a){return Math.atanh(a)},finalTemplate.functors.e=function(e,t,n,r){return Math.E},finalTemplate.functors.pi=function(e,t,n,r){return Math.PI},finalTemplate.functors.seq=function(e,t,n,r,a,o,l){arguments.length<7&&(l=o>a?1:-1);var i=[],u=a;do i.push(u),u+=l;while(o>a?o>=u:u>=o);return i},finalTemplate.functors.fill=function(e,t,n,r,a,o){for(var l=[],i=0;o>i;)l.push(a.constructor==finalTemplate.Operator?a.call(e,t,n,r):a),++i;return l},finalTemplate.functors.push=function(e,t,n,r,a){var a=a.slice(0);return a.push.apply(a,[].slice.call(arguments,5)),a},finalTemplate.functors.pop=function(e,t,n,r,a){var a=a.slice(0);return a.pop(),a},finalTemplate.functors.unshift=function(e,t,n,r,a){var a=a.slice(0);return a.unshift.apply(a,[].slice.call(arguments,5)),a},finalTemplate.functors.shift=function(e,t,n,r,a){var a=a.slice(0);return a.shift(),a},finalTemplate.functors.splice=function(e,t,n,r,a){var a=a.slice(0);return a.splice.apply(a,[].slice.call(arguments,5)),a},finalTemplate.functors.include=function(e,t,n,r,a,o){var a=a.slice(0);return o.forEach(function(e){-1==a.indexOf(e)&&a.push(e)}),a},finalTemplate.functors.exclude=function(e,t,n,r,a,o){var a=a.slice(0);return o.forEach(function(e){var t=a.indexOf(e);-1!=t&&a.splice(t,1)}),a},finalTemplate.functors.concat=function(e,t,n,r,a,o){var a=a.slice(0);return o.forEach(function(e){a.push(e)}),a},finalTemplate.functors.keys=function(e,t,n,r,a){var o=[];for(var l in a)o.push(l);return o},finalTemplate.functors.values=function(e,t,n,r,a){var o=[];for(var l in a)-1==a.indexOf(a[l])&&o.push(a[l]);return o},finalTemplate.functors.each=function(e,t,n,r,a,o){var l={};for(var i in a)l[i]=o.call(e,t,n,r,i,a[i],a);return l},finalTemplate.functors.mix=function(e,t,n,r,a,o){var l={};for(var i in a)l[i]=a[i];for(var i in o)l[i]=o[i];return l},finalTemplate.functors.template=function(e,t,n,r,e,a){var o={};for(var l in r)o[l]=r;return o.parser=\"text/plain\",finalTemplate(e,a,o)},finalTemplate.functors.reverse=function(e,t,n,r,a){return a.slice(0).reverse()},finalTemplate.functors.define=function(e,t,n,r,a,o){if(!/^[a-zA-Z\\$_][a-zA-Z0-9\\$_]*$/g.test(a))throw new Error(\"Invalid variant name: \"+a);for(n.hasOwnProperty(a)||(n[a]=o);n[\"^\"];)n=n[\"^\"],n[a]=o;return n[a]},finalTemplate.functors.random=function(e,t,n,r){return Math.random()},finalTemplate.functors.sandbox=function(e,t,n,r){var a={};for(var o in n)a[o]=n[o];delete a[\"^\"];var l=finalTemplate.run(e,t.arguments[0],a,r);l.call(e,t,a,r)},finalTemplate.functors.isNumber=function(e,t,n,r,a){return null!==a&&void 0!==a&&a.constructor===Number},finalTemplate.functors.isString=function(e,t,n,r,a){return null!==a&&void 0!==a&&a.constructor===String},finalTemplate.functors.isList=function(e,t,n,r,a){return null!==a&&void 0!==a&&(a.constructor===Array||a instanceof Array)},finalTemplate.functors.isDate=function(e,t,n,r,a){return null!==a&&void 0!==a&&a.constructor===Date},finalTemplate.functors.isRegex=function(e,t,n,r,a){return null!==a&&void 0!==a&&a.constructor===RegExp},finalTemplate.functors.isObject=function(e,t,n,r,a){return null!==a&&void 0!==a},finalTemplate.functors.typeOf=function(e,t,n,r,a){return null===a||void 0===a?\"null\":a.constructor===Number?\"number\":a.constructor===String?\"string\":a.constructor===Date?\"date\":a.constructor===RegExp?\"regex\":a.constructor===Array||a instanceof Array?\"list\":\"object\"},finalTemplate.functors.via=function(e,t,n,r,a,o){var l=a;return o.split(\".\").filter(function(e){return e.length>0}).forEach(function(e){null!==l&&void 0!=l&&(l=l[e])}),l},finalTemplate.functors.data=function(e,t,n,r){return n},finalTemplate.functors[\"if\"].lazy=!0,finalTemplate.functors[\"default\"].lazy=!0,finalTemplate.functors.sandbox.lazy=!0,finalTemplate.parsers[\"text/plain\"]=function(e,t,n){for(var r=[],a=0;a<e.length;)if(\"$\"==e[a]&&a+1<e.length&&\"{\"==e[a+1]){var o=[];a+=2;for(var l=a,i=1;i>0&&a<e.length;){var u=finalTemplate.lexer.getSymbol(e,a);\"opr\"==u.type&&(\"{\"==u.content?++i:\"}\"==u.content&&--i),o.push(u),a=u.next}if(i>0){var s=e.substring(Math.max(a-10,0),Math.min(a+10,e.length));throw new Error(\"Bracket not terminated. Code: \"+s)}if(o.pop(),o.length>0){n.log&&console.log(\"Code:   \"+e.substring(l,a-1));var c=finalTemplate.lexer.convertBracket(e,o),c=finalTemplate.lexer.convertSugar(e,c),c=finalTemplate.lexer.convertCall(e,c),c=finalTemplate.lexer.convertOperator(e,c);n.log&&console.log(\"Queue:  \"+finalTemplate.lexer.stringify(c));var f=finalTemplate.lexer.convertQueue(e,c);n.log&&console.log(\"Call:   \"+finalTemplate.lexer.stringify(f));var p=finalTemplate.run(e,f,t,n);n.log&&console.log(\"Result: \"+p),r.push(p)}}else r.push(e[a]),++a;return r.join(\"\")},module.exports={format:finalTemplate,compile:finalTemplate.compile,execute:function(){return arguments[0].constructor===String?finalTemplate.execute.apply(finalTemplate,arguments):finalTemplate.run.apply(finalTemplate,arguments)}};"}},"/library/lab.common/uuid.js":{"url":"/library/lab.common/uuid.js","content":{"encoding":"text","data":"var createUUID=function(){var x=(new Date).getTime(),e=x*x>>8&65535;e=(e*e).toString(16),e=e+e+e+e;var t=\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,function(x){var t=(parseInt(e[e.length-1],16)+16*Math.random())%15|0;return--e.length,(\"x\"===x?t:3&t|8).toString(16)});return t};module.exports={createUUID:createUUID};"}},"/library/lab.kitty/http_kitty.js":{"url":"/library/lab.kitty/http_kitty.js","content":{"encoding":"text","data":"var async=require(\"../lab.common/async.js\"),uuid=require(\"../lab.common/uuid.js\"),ruler=require(\"../lab.common/ruler.js\"),foundation=require(\"../lab.common/foundation.js\"),CachePool=require(\"../lab.common/cache_pool.js\"),Logger=require(\"../lab.common/logger.js\"),IDLE=\"idle\",WAITING=\"waiting\",WORKING=\"working\",HELD=\"held\",FOLLOWING=\"following\",FOLLOWED=\"followed\",TIMEOUT=\"timeout\",RELEASED=\"released\",postMewToRemote=function e(t,n){t.status===WORKING||t.status===WAITING?t.mewSendQueue.push(n):t.status===IDLE&&(n&&t.mewSendQueue.push(n),t.mewSendQueue.length&&(t.status=WAITING,$.async.delay(100,function(){t.status=WORKING,t.logger.info(\"sending mew to server : \"+t.uri),t.mewSendQueue.sort(function(e,t){return e.time.getTime()-t.time.getTime()}),t.logger.info(t.mewSendQueue),$.request(\"POST\",t.uri,JSON.stringify(t.mewSendQueue),{headers:{\"mew-token\":t.mewToken}},function(n,o,r){var i=r.getResponseHeader(\"mew-token\");i&&(t.mewToken=i),t.status=IDLE,e(t)}),t.mewSendQueue=[],(new Date).getTime()-t.mewCaches.lastClearDate>1e3&&t.mewCaches.clearExpired()})))},startListenFromRemote=function t(e){$.request(\"GET\",e.uri,{},{headers:{\"mew-token\":e.mewToken}},function(n,o,r){var i=r.getResponseHeader(\"mew-token\");if(i&&(e.mewToken=i),e.status=IDLE,o&&Array.isArray(o)){e.logger.info(\"receiving mew from server : \"+e.uri),e.logger.info(o);try{o.forEach(function(t){try{e.onHeardMew(t)}catch(n){}}),e.errorNumber=0}catch(a){e.errorNumber=e.errorNumber+1}}else e.errorNumber=e.errorNumber+1;var s=e.errorNumber>30?3e4:Math.log(e.errorNumber)/Math.log(1.00014);$.async.delay(s,function(){e.closed||t(e)}),(new Date).getTime()-e.mewCaches.lastClearDate>1e3&&e.mewCaches.clearExpired()})},KittyMew=function(e,t,n,o){this.options=foundation.advancedMerge({timeout:{\"!valueType\":\"number\",\"!defaultValue\":5e3},id:{\"!valueType\":\"string\",\"!defaultValue\":uuid.createUUID()},requireReply:{\"!valueType\":\"boolean\",\"!defaultValue\":!1},follow:{\"!valueType\":\"string\"},reply:{\"!valueType\":\"string\"}},o),this.options.time=foundation.formatDate(new Date,\"YYYY-MM-DDThh:mm:ss.SSSZ\"),this.play=e,this.usage=t,this.content=n,Object.defineProperty(this,\"time\",{enumerable:!1,value:new Date}),Object.defineProperty(this.options,\"expiredDate\",{enumerable:!1,value:(new Date).getTime()+this.options.timeout}),[\"repliedActions\",\"amendedActions\",\"replies\",\"amends\"].forEach(function(e){Object.defineProperty(this,e,{enumerable:!1,value:[]})}.bind(this)),Object.defineProperty(this,\"status\",{enumerable:!1,value:WAITING}),this.options.requireReply&&Object.defineProperty(this,\"timeoutSchedule\",{enumerable:!1,value:async.delay(this.options.timeout,function(){var e={usage:\"mew.timeout\",content:{\"mew.timeout\":null},options:{reply:this.options.id}};this.repliedActions.forEach(function(t){t.call({},e)})}.bind(this))})};KittyMew.prototype.replied=function(e){return this.repliedActions.push(e),this.replies.slice(0).forEach(function(t){e.call({},t)}),this},KittyMew.prototype.amended=function(e){return this.amendedActions.push(e),this.amends.slice(0).forEach(function(t){e.call({},t)}),this};var MewContent=function(e){Object.keys(e).forEach(function(t){\"!\"!==t[0]&&(this[t]=e[t])}.bind(this))};MewContent.ensure=function(e,t){if(e instanceof MewContent)return e;if(e&&e[\"!content\"])return new MewContent(e);t||(t=\"mew.unknown\");var n={};return n[t]=e,new MewContent(n)},MewContent.unwrap=function(e){if(e instanceof MewContent){var t={\"!content\":!0};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}return e[\"!content\"]?e:{\"!content\":!0,\"mew.unknown\":e}};var KittyMewReceived=function(e,t){this.play=t.play,this.usage=t.usage,this.content=t.content,this.options=t.options,this.kitty=e;var t=this;Object.defineProperty(this,\"options\",{enumerable:!1,value:foundation.advancedMerge({timeout:{\"!valueType\":\"number\",\"!defaultValue\":5e3},holdTimeout:{\"!valueType\":\"number\"},minHoldTimeout:{\"!valueType\":\"number\",\"!defaultValue\":0}},t.options?t.options:{})}),foundation.isKindOf(t.options.holdTimeout,Number)||(this.options.holdTimeout=t.options.timeout/20),this.options.holdTimeout<t.options.minHoldTimeout&&(this.options.holdTimeout=t.options.minHoldTimeout),this.options.timeout<t.options.holdTimeout&&(this.options.holdTimeout=t.options.timeout),this.options.expiredDate=(new Date).getTime()+this.options.timeout,this.options.holdExpiredDate=(new Date).getTime()+this.options.holdTimeout,Object.defineProperty(this,\"state\",{enumerable:!1,value:WAITING})};Object.defineProperty(KittyMewReceived.prototype,\"getContent\",{enumerable:!1,value:function(){for(var e=this,t=(Object.keys(this.content),0);t<arguments.length;){var n=arguments[t];if(this.content.hasOwnProperty(n))return async(function(){this.next(n,e.content[n])});++t}return async.reject(new Error(\"No data matched preferred types\"))}}),KittyMewReceived.prototype.makeSnapshot=function(){var e=this,t=uuid.createUUID(),n=foundation.advancedMerge({},{play:e.play,usage:e.usage,content:e.content});return Object.defineProperty(n,\"options\",{enumerable:!1,value:foundation.advancedMerge({},{requireReply:e.options.requireReply,holdTimeout:e.options.holdTimeout,holdExpiredDate:e.options.holdExpiredDate,timeout:e.options.timeout,expiredDate:e.options.expiredDate})}),Object.defineProperty(n,\"getContent\",{enumerable:!1,value:function(){for(var t=(Object.keys(n.content),0);t<arguments.length;){var o=arguments[t];if(n.content.hasOwnProperty(o))return async(function(){this.next(o,e.content[o])});++t}return async.reject(new Error(\"No data matched preferred types\"))}}),Object.defineProperty(n,\"hold\",{enumerable:!1,value:function(){var n=void 0,o=void 0;return foundation.isKindOf(arguments[0],Number)&&(n=arguments[0]),foundation.isKindOf(arguments[0],Function)?o=arguments[0]:foundation.isKindOf(arguments[1],Function)&&(o=arguments[1]),e.hold(n,o,!1,t)}}),Object.defineProperty(n.hold,\"thread\",{enumerable:!1,value:function(){var n=void 0,o=void 0;return foundation.isKindOf(arguments[0],Number)&&(n=arguments[0]),foundation.isKindOf(arguments[0],Function)?o=arguments[0]:foundation.isKindOf(arguments[1],Function)&&(o=arguments[1]),e.hold(n,o,!0,t)}}),n},KittyMewReceived.prototype.hold=function(e,t,n,o){var r=this,i=HELD,a=[];t&&a.push(t);var s=null;if(this.state===HELD||this.state===WAITING){var u=(new Date).getTime();(void 0===e||null===e||u+e>this.options.expiredDate)&&(e=this.options.expiredDate-u);var l=this.options.holdExpiredDate;if(this.state===WAITING?this.state=HELD:l=this.options.expiredDate,l>u){s=async.delay(e,function(){s=null;var e=a;a=[],(i===HELD||i===FOLLOWING)&&(i=TIMEOUT,e.forEach(function(e){e.call({follow:d,release:p})}))});var c=foundation.advancedMerge({},{play:{},usage:\"@mew.hold\",content:{\"!content\":!0,\"@mew.hold\":{play:r.play,usage:r.usage,content:r.content,threaded:n,holdID:o}},options:{time:new Date,follow:r.options.id,id:uuid.createUUID(),reply:null}});Object.defineProperty(c,\"time\",{enumerable:!1,value:new Date}),postMewToRemote(r.kitty,c)}else void 0!==e&&null!==e&&(i=TIMEOUT)}var d=function(e,t,u){if(s&&(s.cancel(),s=null),a=[],i===FOLLOWING||n){i=FOLLOWED,u=foundation.advancedMerge({},{},u),u.id||(u.id=uuid.createUUID()),u.follow=r.options.id,u.time=new Date,u.holdID=o;var l=foundation.advancedMerge({},{play:r.play,usage:e,content:t,options:u});if(Object.defineProperty(l,\"time\",{enumerable:!1,value:new Date}),postMewToRemote(r.kitty,l),!n){var c=foundation.advancedMerge({},{play:null,usage:\"@mew.release\",content:{\"!content\":!0,\"@mew.release\":{play:r.play,usage:r.usage,content:r.content,threaded:n,holdID:o}},options:{time:new Date,follow:r.options.id,id:uuid.createUUID()}});Object.defineProperty(c,\"time\",{enumerable:!1,value:new Date}),postMewToRemote(r.kitty,c)}return l}if(i!==TIMEOUT)throw new Error(\"Duplicated reactios is not allowed for one hold\");var h=a;a=[],h.forEach(function(e){e.call({follow:d,release:p})})},p=function(e,t,u){if(s&&(s.cancel(),s=null),a=[],i!==FOLLOWING&&!n)throw new Error(\"Duplicated reactions is not allowed for one hold\");i=RELEASED;var l=foundation.advancedMerge({},{play:null,usage:\"@mew.release\",content:{\"!content\":!0,\"mew.hold\":{play:r.play,usage:r.usage,content:r.content,threaded:n,holdID:o}},options:{time:new Date,follow:r.options.id,id:uuid.createUUID()}});postMewToRemote(r.kitty,l)},h={then:function(e){if(i!==HELD)throw new Error(\"Only one then action could be set currently\");return i=FOLLOWING,e.call({follow:d,release:p}),h},timeout:function(e){return i===TIMEOUT?e.call({follow:d,release:p}):(i===HELD||i===FOLLOWING)&&a.push(e),h}};return h};var HTTPKitty=function(e,t){this.options=foundation.advancedMerge({\"!valueType\":\"object\",\"!defaultValue\":{},defaultMewTimeout:{\"!valueType\":\"number\",\"!defaultValue\":5e3},logLevel:{\"!valueType\":\"string\",\"!defaultValue\":\"error\"},delegate:{\"!valueType\":\"object\",\"!defaultValue\":null}},t);var n=this;this.logger=new Logger({logLevel:this.options.logLevel}),this.interestsIndex={},this.rulebase={},this.ruler=\"simple\",this.uri=e,this.mewToken=null,this.options.delegate?this.delegate=this.options.delegate:this.delegate={},this.sessionContext={},this.closed=!1,this.respondents={},this.connected=!1,this.mewCaches=new CachePool(this.options.defaultMewTimeout),this.mewSendQueue=[],this.errorNumber=0,this.status=IDLE,Object.defineProperty(this,\"mew\",{enumerable:!1,value:function(){var e=null,t=null,n=null,o=null;if(foundation.isKindOf(arguments[0],String)?(t=arguments[0],n=arguments[1],o=arguments[2]):(e=arguments[0],t=arguments[1],n=arguments[2],o=arguments[3]),!/^[a-z0-9_\\.]+$/gim.test(t))throw new Error(\"Invalid usage for mew: \"+t);o||(o={});var r=new KittyMew(e,t,n,o);return(new Date).getTime()-this.mewCaches.lastClearDate>1e3&&this.mewCaches.clearExpired(),this.mewCaches.put(r.options.id,r,2*r.options.timeout),postMewToRemote(this,r),r}}),Object.defineProperty(this,\"heard\",{enumerable:!1,value:function(e,t){var n=this,o=[];e.toString().split(/[,\\s]/g).forEach(function(e){e=e.trim(),e.length>0&&-1===o.indexOf(e)&&o.push(e)});var r=[];t.toString().split(/[,\\s]/g).forEach(function(e){e=e.trim(),e.length>0&&-1===r.indexOf(e)&&r.push(e)});var i=[];o.forEach(function(e){r.forEach(function(t){n.respondents[e]||(n.respondents[e]={}),n.respondents[e][t]||(n.respondents[e][t]=[]),n.respondents[e][t].push(i)})});var a={then:function(e){return i.push(e),a}},s={usages:r,friends:o},u=JSON.stringify(s);if(!n.interestsIndex[u]){n.interestsIndex[u]=s;var l=new KittyMew(null,\"@mew.interests\",{\"!content\":!0,\"@mew.interests\":[s]},{});postMewToRemote(n,l)}return a}}),Object.defineProperty(this.heard,\"hold\",{enumerable:!1,value:function(e,t){var n=null;this.heard(e,t).then(function(e){e.hold().then(function(){n.call(this,e)})});var o={then:function(e){if(n)throw new Error(\"Only one then could be followed currently\");return n=e,o}};return o}.bind(this)}),Object.defineProperty(this.mew,\"rpc\",{enumerable:!1,value:function(){var e=null,t=null,o=null,r=null;foundation.isKindOf(arguments[0],String)?(t=arguments[0],o=arguments[1],r=arguments[2]):(e=arguments[0],t=arguments[1],o=arguments[2],r=arguments[3]);var i;$.isKindOf(o,Object)&&o[\"!content\"]?i=o:(i={\"!content\":!0},i[\"rpc.call.\"+t]=o);var a=n.mew.call(n,e,\"rpc.call.\"+t,i,foundation.merge({requireReply:!0},r?r:{}));return Object.defineProperty(a,\"replied\",{enumerable:!1,value:function(e){return function(n){return 2===n.length&&(n=function(e){return function(n){n.content.hasOwnProperty(\"mew.exception\")?e.call(this,n.content[\"mew.exception\"],null,n):\"mew.ignore\"===n.usage?e.call(this,new Error(\"Mew has been ignored by kitties\"),null,n):\"mew.timeout\"===n.usage?e.call(this,new Error(\"RPC procedure has been timeout\"),null,n):e.call(this,null,n.content[\"rpc.reply.\"+t],n)}}(n)),e.call(this,n)}}(a.replied)}),a}}),Object.defineProperty(this.heard,\"rpc\",{enumerable:!1,value:function(){var e=null,t=null;arguments.length>1?(e=[arguments[0]].join(\" \"),t=[arguments[1]].join(\" \")):(e=\"*\",t=[arguments[0]].join(\" \"));var o=null;n.heard(e,t.split(/[,\\s]+/).map(function(e){return e?\"rpc.call.\"+e.trim():\"\"}).filter(function(e){return e&&e.length>0}).join(\" \")).then(function(e){e.hold().then(function(){r=this;var t=e.usage.split(\".\").slice(2).join(\".\"),n=function(e,t){e?i.error(e):i.reply(t)},i={reply:function(e){if(!e||!e[\"!content\"]){var n={\"!content\":!0};n[\"rpc.reply.\"+t]=e,e=n}r.follow(\"rpc.reply.\"+t,e)},error:function(e){foundation.isKindOf(e,Content)||e&&e[\"!content\"]||(foundation.isKindOf(e,String)&&(e=new Error(e)),foundation.isKindOf(e,Error)?e={\"!content\":!0,\"mew.exception\":{message:e.message,stack:e.stack}}:e&&e[\"!content\"]||(e={\"!content\":!0,\"mew.exception\":e})),r.follow(\"rpc.reply.\"+t,e)}};o.call(i,t,e.content[\"rpc.call.\"+t],n,e)})});var r={then:function(e){if(o)throw new Error(\"Only one then could be followed currently\");return o=e,r}};return r}}),startListenFromRemote(this)};HTTPKitty.prototype.close=function(){this.closed=!0},HTTPKitty.prototype.addRules=function(e){this.rulebase=ruler[this.ruler].addRules(this.rulebase,e);var t=new KittyMew(null,\"@mew.interests\",{\"!content\":!0,\"@mew.rules\":{ruler:this.ruler,rules:e}},{});return postMewToRemote(this,t),this.rules},Object.defineProperty(HTTPKitty.prototype,\"executeDelegate\",{enumerable:!1,value:function(e){e&&foundation.isKindOf(this.delegate[e],Function)&&this.delegate[e].apply(this,Array.prototype.slice.call(arguments,1))}}),Object.defineProperty(HTTPKitty.prototype,\"onHeardMew\",{enumerable:!1,value:function(e){var t=this,n=!1;if(\"@\"==e.usage[0]&&(n=!0),n)switch(e.usage){case\"@connection.reset\":if(t.connected){t.executeDelegate(\"didConnectionReset\",t.mewToken);var o=[],r=ruler[t.ruler].exportRules(t.rulebase);if(Object.keys(t.interestsIndex).forEach(function(e){var n=t.interestsIndex[e];o.push(n)}),o.length||r.length){var i=new KittyMew(null,\"@mew.interests\",{\"!content\":!0,\"@mew.interests\":o,\"@mew.rules\":{rules:r,ruler:t.ruler}},{});postMewToRemote(t,i)}}else t.executeDelegate(\"didConnectionConnected\",t.mewToken),t.connected=!0;break;case\"@mew.reply\":var a=e.content[\"@mew.reply\"];if(foundation.isKindOf(a.options.reply,String)&&(replyToMew=t.mewCaches.get(a.options.reply),replyToMew)){var s=(new Date).getTime()>replyToMew.options.expiredDate;s?replyToMew.amendedActions.forEach(function(e){e.call({},a)}):(replyToMew.timeoutSchedule&&replyToMew.timeoutSchedule.cancel(),replyToMew.repliedActions.forEach(function(e){e.call({},a)}))}}else{var u=[];t.respondents.hasOwnProperty(\"*\")&&u.push(t.respondents[\"*\"]),e.from.split(\".\").forEach(function(n,o,r){if(o!==r.length-1){var i=r.slice(0,o+1).join(\".\")+\".*\";t.respondents.hasOwnProperty(i)&&u.push(t.respondents[i])}else t.respondents.hasOwnProperty(e.from)&&u.push(t.respondents[e.from])});var l=[];u.forEach(function(t){t.hasOwnProperty(\"*\")&&t[\"*\"].forEach(function(e){e.forEach(function(e){-1===l.indexOf(e)&&l.push(e)})}),e.usage.split(\".\").forEach(function(n,o,r){if(o!==r.length-1){var i=r.slice(0,o+1).join(\".\")+\".*\";t.hasOwnProperty(i)&&t[i].forEach(function(e){e.forEach(function(e){-1===l.indexOf(e)&&l.push(e)})})}else t.hasOwnProperty(e.usage)&&t[e.usage].forEach(function(e){e.forEach(function(e){-1===l.indexOf(e)&&l.push(e)})})})});var c=new KittyMewReceived(t,e);l.forEach(function(e){e.call(t,c.makeSnapshot())})}}}),module.exports=HTTPKitty;"}},"/library/lab.module/index.js":{"url":"/library/lab.module/index.js","content":{"encoding":"text","data":"!function(){Object.defineProperty(this.constructor.prototype,\"global\",{enumerable:!0,get:function(){return this}}),Object.defineProperty(global,\"Global\",{enumerable:!0,value:global.constructor});var e=function(e){e=parseInt(e),isFinite(e)||(e=0);try{var t=new Error(\"937b84bb-7953-4443-be30-34ba130b98e7\").stack.split(\"\\n\"),n=null;return n=-1!==t[0].indexOf(\"937b84bb-7953-4443-be30-34ba130b98e7\")?t[2+e]:t[1+e],\"    at \"===n.substring(0,7)?n=n.split(\"at\").slice(1).join(\"at\"):(n=n.split(\"@\"),n=n.length>1?n.slice(1).join(\"@\"):n[0]),\")\"===n[n.length-1]&&(n=n.split(\"(\").slice(1).join(\"(\").slice(0,-1)),n.trim()}catch(r){return\"lab://unknown-file:NaN:NaN\"}};Object.defineProperty(Global.prototype,\"__dirname\",{enumerable:!1,configurable:!1,get:function(){return e(1).split(\":\").slice(0,-2).join(\":\").split(\"/\").slice(0,-1).join(\"/\")}}),Object.defineProperty(Global.prototype,\"__filename\",{enumerable:!1,configurable:!1,get:function(){return e(1).split(\":\").slice(0,-2).join(\":\")}}),Object.defineProperty(Global.prototype,\"__line\",{enumerable:!1,configurable:!1,get:function(){return parseInt(e(1).split(\":\").slice(-2,-1)[0])}}),Object.defineProperty(Global.prototype,\"__column\",{enumerable:!1,configurable:!1,get:function(){return parseInt(e(1).split(\":\").slice(-1)[0])}});var t={},n=(__filename.split(\"/\").slice(0,3).join(\"/\"),{}),r=function(e,o,i,l){var s=this;if(i&&(t[o]=this),this.parent=e,this.id=o,this.filename=o,this.loaded=!1,this.children=[],this.exports={},this.require=function(e,t){if(\".\"===e[0]&&(e=this.id.split(\"/\").slice(0,-1).join(\"/\")+\"/\"+e),!n[e]){var o=null;-1!==e.indexOf(\"://\")?(o=[e.split(\"/\").slice(0,3).join(\"/\")],e=\"/\"+e.split(\"/\").slice(3).join(\"/\")):o=[this.id.split(\"/\").slice(0,3).join(\"/\")],e=e.replace(/\\/+/gm,\"/\").split(\"/\"),\"/\"===e[0]&&(e=e.slice(1)),e.forEach(function(e){if(\"..\"===e){if(!(o.length>1))throw new Error(\"Invalid path to resolve for module require\");o.pop()}else\".\"===e||0===e.length||o.push(e)}),e=o.join(\"/\")}return r.get(this,e,t).exports}.bind(this),global.document&&(0!==Array.prototype.filter.call(document.querySelectorAll(\"script\"),function(e){return e.src===o}).length||document.documentURI.split(\"#\")[0].split(\"?\")[0]===o)||n[o])n[o]=!0;else{n[o]=!0;var a=function(e){global[function(){return\"eval\"}()](\"(function () { return function (module, require, exports, __filename, __diranme) {\"+e+\"}; })(); //@ sourceURL=\"+o)(s,s.require,s.exports,s.id,s.id.split(\"/\").slice(0,-1).join(\"/\"),s.exports)};if(global.$&&global.$.loadResources&&(l||global.$.isResourceCached(o)))global.$.loadResources(o,function(e,t){e?l&&l(e):(a(t[o]),l&&l(null,s.exports))});else{var c=new XMLHttpRequest;l&&c.addEventListener(\"readystatechange\",function(){if(4===c.readyState)switch(c.status%100){case 0:case 2:a(c.responseText),l(null,s.exports);break;default:l(new Error(\"Failed to module \"+path))}}),c.open(\"GET\",o,l?!0:!1),c.send(),l||a(c.responseText)}}};r.get=function(e,n,o){return t.hasOwnProperty(n)?(o&&o(null,t[n].exports),t[n]):(null===e&&(e=t[__filename]),new r(e,n,!0,o))},r._extensions={};var o=function(t,n){var o=e(1+n).split(\":\").slice(0,-2).join(\":\");return o?r.get(t,o):c};Object.defineProperty(Global.prototype,\"module\",{enumerable:!1,configurable:!1,get:function(){return o(null,1)}}),Object.defineProperty(Global.prototype,\"require\",{enumerable:!1,configurable:!1,get:function(){return o(null,1).require}}),Object.defineProperty(Global.prototype,\"exports\",{enumerable:!1,configurable:!1,get:function(){return o(null,1).exports},set:function(e){o(null,1).exports=e}});var i=function(e,t){n[e]=!0;var o=new r(module,e,!0);Object.keys(t).forEach(function(e){o.exports[e]=t[e]})},l=function(){throw new Error(\"Not implemented\")},s=function(){arguments[arguments.length-1](new Error(\"Not implemented\"))},a=global.document.documentURI.split(\"#\")[0].split(\"?\")[0],c=r.get(null,a),u=(new Date).getTime();i(\"module\",r),i(\"os\",{tmpdir:function(){return null},endianness:function(){return\"BE\"},type:function(){return\"browser\"},hostname:function(){return\"browser\"},platform:function(){return\"browser\"},arch:function(){return\"js\"},release:function(){return\"0.1.0\"},uptime:function(){return((new Date).getTime()-u)/1e3},loadavg:function(){return[0,0,0]},totalmem:function(){return 1/0},freemem:function(){return 1/0},cpus:function(){return[{model:\"Browser Javascript CPU\",speed:1/0,times:{user:0,nice:0,sys:0,idle:0,irq:0}}]}}),i(\"path\",{normalize:function(e){var t=e.split(\"://\");return t.length>1?t[0]+\"://\"+t.slice(1).join(\"://\").replace(/\\/+/g,\"/\").replace(/\\/.\\//g,\"/\").replace(/\\/[^\\/]\\/..\\//g,\"/\"):t.join(\"://\").replace(/\\/+/g,\"/\").replace(/\\/.\\//g,\"/\").replace(/\\/[^\\/]\\/..\\//g,\"/\")},join:function(){return this.normalize(Array.prototype.join.call(arguments,\"/\"))},resolve:function(){for(var e=null,t=0;t<arguments.length;)e=-1!==arguments[t].indexOf(\"://\")?arguments[t]:e+\"/\"+arguments[t],++t;return this.normalize(e)},isAbsolute:function(e){return-1!==arguments[looper].indexOf(\"://\")},relative:function(e,t){if(basePathComponents=e.split(\"/\"),pathComponents=t.split(\"/\"),pathComponents[0]!==basePathComponents[0]||pathComponents[1]!==basePathComponents[1]||pathComponents[2]!==basePathComponents[2])return t;for(var n=3;n<basePathComponents.length&&pathComponents[n]===basePathComponents[n];)++n;for(var r=[];n<pathComponents.length;)n<basePathComponents.length&&r.unshift(\"..\"),r.push(pathComponents[n]),++n;return r.join(\"/\")},dirname:function(e){return e.split(\"/\").slice(0,-1).join(\"/\")},basename:function(e,t){var n=e.split(\"/\").slice(-1)[0];return t&&n.substring(n.length-t.length,n.length)===t&&(n=n.substring(n.length-t.length)),n},extname:function(e){var t=e.split(\"/\").slice(-1)[0].split(\".\");return t.length>1&&(t[0].length>0||t.length>2)?t[t.length-1]:\"\"},sep:\"/\",delimiter:\":\"}),i(\"fs\",{Stats:l,FSWatcher:l,ReadStream:l,WriteStream:l,exists:function(e,t){t(!1)},existsSync:function(e){return!1},readFile:s,readFileSync:l,writeFile:s,writeFileSync:l,truncate:s,truncateSync:l,unlink:s,unlinkSync:l,stat:s,statSync:l,lstat:s,lstatSync:l,readdir:s,readdirSync:l,mkdir:s,mkdirSync:l,rmdir:s,rmdirSync:l,rename:s,renameSync:l,link:s,linkSync:l,symlink:s,symlinkSync:l,readlink:s,readlinkSync:l,chmod:s,chmodSync:l,lchmod:s,lchmodSync:l,chown:s,chownSync:l,lchown:s,lchownSync:l,access:s,accessSync:l,utimes:s,utimesSync:l,realpath:s,realpathSync:l,open:s,openSync:l,read:s,readSync:l,write:s,writeSync:l,close:s,closeSync:l,append:s,appendSync:l,ftruncate:s,ftruncateSync:l,fstat:s,fstatSync:l,fsync:s,fsyncSync:l,fchmod:s,fchmodSync:l,fchown:s,fchownSync:l,futimes:s,futimesSync:l,createReadStream:l,createWriteStream:l,watch:l,watchFile:l,unwatchFile:l});var p=a.split(\"/\").slice(0,-1).join(\"/\"),f=0,m=\"deb93a6f-d613-44f5-b82c-c58e8b0a3e2f\",d=[];window.addEventListener(\"message\",function(e){e.source===window&&e.data&&e.data.signature===m&&e.stopPropagation();var t=d;d=[],t.forEach(function(e){try{e.job.apply(window,e.arguments)}catch(t){global.$&&global.$.reportError?global.$.reportError(t):setTimeout(function(){throw t})}})}),i(\"<anonymous>\",{}),i(\"process\",{cwd:function(){return p},chdir:l,exit:l,kill:l,abort:l,umask:511,getgid:function(){return 0},getuid:function(){return 0},setgid:l,setuid:l,hrtime:function(){var e=(new Date).getTime(),t=(e-f)/1e3;return f=e,[Math.floor(t),t-Math.floor(t)]},uptime:function(){return((new Date).getTime()-u)/1e3},nextTick:function(e){d.push({job:e,arguments:[].slice.call(arguments,1)}),window.postMessage({signature:m},\"*\")},getgroups:l,setgroups:l,initgroups:l,memoryUsage:l,env:{HOME:p},pid:0,arch:\"js\",platform:\"browser\",title:\"browser\",version:\"0.1.0\",argv:[\"browser\",a],execArgv:[],execPath:\"browser\",stdin:null,stderr:null,stdout:null,exitCode:0,config:{},versions:{},mainModule:c.exports}),global.process=t.process.exports}();"}},"/library/lab.module/ready.js":{"url":"/library/lab.module/ready.js","content":{"encoding":"text","data":"$(function(){var o,t=\"/mewchan.ui\";o=$.uiKittyBURL?$.uiKittyBURL:window.location.protocol+\"//\"+window.location.hostname+(window.location.port?\":\"+window.location.port:\"\")+t,$.uiKitty=new $.HTTPKittyClient(o,{logLevel:\"info\"}),$.uiReadyStatus=\"READY\",$.uiReadyListeners.forEach(function(o){try{o($.uiKitty)}catch(t){console.log(t)}})});"}}}